<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="NovaHangman - An AI-powered word guessing game with stunning visuals">
    <title>NovaHangman | AI Powered Game</title>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700;800&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        mono: ['"JetBrains Mono"', 'monospace'],
                    },
                    colors: {
                        nova: {
                            dark: '#121212',
                            darkAlt: '#1a1a1a',
                            cyan: '#00E5FF',
                            red: '#FF2E63',
                            green: '#08D9D6',
                        }
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            },
            darkMode: 'class'
        }
    </script>

    <style>
        body {
            background-color: #121212;
            overflow-x: hidden;
            margin: 0;
            padding: 0;
        }
        
        body.light-mode {
            background-color: #f5f5f5;
        }
        
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1e1e1e; 
        }
        ::-webkit-scrollbar-thumb {
            background: #333; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #00E5FF; 
        }

        .neon-text {
            text-shadow: 0 0 10px rgba(0, 229, 255, 0.7), 0 0 20px rgba(0, 229, 255, 0.5);
        }
        
        .neon-stroke {
            filter: drop-shadow(0 0 2px #00E5FF) drop-shadow(0 0 5px #00E5FF);
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .light-mode .glass-panel {
            background: rgba(255, 255, 255, 0.7);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .key-btn {
            transition: all 0.15s ease;
        }
        .key-btn:active {
            transform: scale(0.95);
        }
        .key-btn:focus {
            outline: 2px solid #00E5FF;
            outline-offset: 2px;
        }

        .error-fallback {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background: #121212;
            color: #FF2E63;
            font-family: 'JetBrains Mono', monospace;
            padding: 2rem;
            text-align: center;
        }

        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: #00E5FF;
            color: #121212;
            padding: 8px;
            text-decoration: none;
            z-index: 100;
        }
        .skip-link:focus {
            top: 0;
        }

        .settings-icon {
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        .settings-icon:hover {
            transform: rotate(90deg);
        }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useCallback, useReducer } = React;
        const { motion, AnimatePresence } = window.Motion;

        // ============================================
        // CONFIGURATION & CONSTANTS
        // ============================================
        
        const API_CONFIG = {
            endpoint: "https://gen.pollinations.ai/text/",
            model: "nova-fast",
            key: "pk_8CQPK8dxqANijjhy"
        };

        const GAME_CONFIG = {
            standardMaxMistakes: 6,
            extendedMaxMistakes: 20,
            requestTimeout: 10000,
            maxRetries: 3,
            maxWordLength: 50
        };

const DIFFICULTY_LEVELS = {
    simple: { 
        name: "Simple Words", 
        prompt: "a simple common English word that an elementary school student would know (examples: apple, house, friend, water). Output ONLY the word with no punctuation or explanation.",
        minLength: 3,
        maxLength: 8
    },
    common: { 
        name: "Common Words", 
        prompt: "a common English word that a middle school student would know (examples: telescope, mountain, library, adventure). Output ONLY the word with no punctuation or explanation.",
        minLength: 5,
        maxLength: 12
    },
    hard: { 
        name: "Hard Words", 
        prompt: "a challenging English word that a high school student would know (examples: hypothesis, democracy, momentum, photosynthesis). Output ONLY the word with no punctuation or explanation.",
        minLength: 7,
        maxLength: 15
    },
    challenging: { 
        name: "Challenging Words", 
        prompt: "an advanced English word that a college student would know (examples: epistemology, metamorphosis, equilibrium, circumstantial). Output ONLY the word with no punctuation or explanation.",
        minLength: 8,
        maxLength: 18
    },
    ridiculous: { 
        name: "Ridiculous Words", 
        prompt: "an extremely difficult technical or professional jargon word (examples: pneumonoultramicroscopicsilicovolcanoconiosis, floccinaucinihilipilification, electroencephalography, otorhinolaryngology). Output ONLY the word with no punctuation or explanation.",
        minLength: 10,
        maxLength: 30
    },
    simplePhrase: { 
        name: "Simple Phrases", 
        prompt: "a simple 2-3 word phrase an elementary student would know (examples: red apple, big tree, ice cream, happy birthday). Output ONLY the phrase with no punctuation or explanation.",
        minLength: 6,
        maxLength: 15
    },
    commonPhrase: { 
        name: "Common Phrases", 
        prompt: "a common idiom or popular short quote like from Wheel of Fortune (examples: piece of cake, break a leg, time flies, better late than never). Output ONLY the phrase with no punctuation or explanation.",
        minLength: 8,
        maxLength: 25
    },
    complicatedPhrase: { 
        name: "Complicated Phrases", 
        prompt: "a phrase or sentence from high school level literature (examples: to be or not to be, all the worlds a stage, it was the best of times, for whom the bell tolls). Output ONLY the phrase with no punctuation or explanation.",
        minLength: 10,
        maxLength: 35
    },
    hardPhrase: { 
        name: "Hard Phrases", 
        prompt: "a college level literature quote or technical phrase from Shakespeare or advanced subjects (examples: shall i compare thee to a summers day, the fault dear brutus is not in our stars, mitochondria is the powerhouse of the cell). Output ONLY the phrase with no punctuation or explanation.",
        minLength: 15,
        maxLength: 45
    },
    technicalPhrase: { 
        name: "Technical Phrases", 
        prompt: "a highly technical job-specific phrase with advanced jargon (examples: idiopathic hypertrophy manifests systemic cachexia, quantum entanglement exhibits nonlocal correlation, differential diagnosis requires comprehensive metabolic panel). Output ONLY the phrase with no punctuation or explanation.",
        minLength: 20,
        maxLength: 60
    }
};

const FALLBACK_WORDS = {
    simple: ["APPLE", "HOUSE", "WATER", "FRIEND", "BOOK", "HAPPY", "SCHOOL", "FAMILY"],
    common: ["TELESCOPE", "MOUNTAIN", "LIBRARY", "ADVENTURE", "ELEPHANT", "RAINBOW", "BICYCLE", "GUITAR"],
    hard: ["HYPOTHESIS", "DEMOCRACY", "MOMENTUM", "PHOTOSYNTHESIS", "ENCYCLOPEDIA", "TEMPERATURE", "ATMOSPHERE"],
    challenging: ["EPISTEMOLOGY", "METAMORPHOSIS", "EQUILIBRIUM", "CIRCUMSTANTIAL", "PHILOSOPHICAL", "UNPRECEDENTED"],
    ridiculous: ["ELECTROENCEPHALOGRAPHY", "OTORHINOLARYNGOLOGY", "IMMUNOHISTOCHEMISTRY", "FLOCCINAUCINIHILIPILIFICATION"],
    simplePhrase: ["RED APPLE", "BIG TREE", "ICE CREAM", "HAPPY BIRTHDAY", "BLUE SKY", "LONG BOOKS"],
    commonPhrase: ["PIECE OF CAKE", "BREAK A LEG", "TIME FLIES", "BETTER LATE THAN NEVER", "EASY AS PIE"],
    complicatedPhrase: ["TO BE OR NOT TO BE", "ALL THE WORLDS A STAGE", "IT WAS THE BEST OF TIMES", "FOR WHOM THE BELL TOLLS"],
    hardPhrase: ["SHALL I COMPARE THEE TO A SUMMERS DAY", "THE FAULT IS NOT IN OUR STARS", "SOMETHING IS ROTTEN IN THE STATE OF DENMARK"],
    technicalPhrase: ["IDIOPATHIC HYPERTROPHY MANIFESTS SYSTEMIC CACHEXIA", "QUANTUM ENTANGLEMENT EXHIBITS NONLOCAL CORRELATION"]
};
        const FIGURE_TYPES = {
            classic: "Classic Stick Figure",
            man: "Man",
            woman: "Woman", 
            cat: "Cat",
            dog: "Dog",
            elephant: "Elephant",
            pig: "Pig",
            horse: "Horse",
            chicken: "Chicken",
            alien: "Space Alien"
        };

        const CLOTHING_COLORS = ["#FF6B6B", "#4ECDC4", "#45B7D1", "#FFA07A", "#98D8C8", "#F7DC6F", "#BB8FCE", "#85C1E2"];
        const FACIAL_HAIR_COLORS = ["#2C3E50", "#8B4513", "#DAA520", "#696969", "#000000"];
        const EYE_COLORS = ["#4A90E2", "#2ECC71", "#8B4513", "#95A5A6"];

        // ============================================
        // UTILITY FUNCTIONS
        // ============================================

        const sanitizeWord = (text) => {
            if (!text || typeof text !== 'string') return '';
            
            return text
                .replace(/[^A-Za-z\s]/g, '')
                .replace(/\s+/g, ' ')
                .trim()
                .toUpperCase()
                .slice(0, GAME_CONFIG.maxWordLength);
        };

        const fetchWithTimeout = async (url, options = {}, timeout = GAME_CONFIG.requestTimeout) => {
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), timeout);

            try {
                const response = await fetch(url, {
                    ...options,
                    signal: controller.signal
                });
                clearTimeout(timeoutId);
                return response;
            } catch (error) {
                clearTimeout(timeoutId);
                throw error;
            }
        };

        const fetchWithRetry = async (url, retries = GAME_CONFIG.maxRetries) => {
            for (let i = 0; i < retries; i++) {
                try {
                    return await fetchWithTimeout(url);
                } catch (error) {
                    if (i === retries - 1) throw error;
                    await new Promise(resolve => setTimeout(resolve, 1000 * Math.pow(2, i)));
                }
            }
        };

        const getRandomFallbackWord = (difficulty) => {
            const words = FALLBACK_WORDS[difficulty] || FALLBACK_WORDS.easy;
            return words[Math.floor(Math.random() * words.length)];
        };

        const getRandomColor = (colorArray) => {
            return colorArray[Math.floor(Math.random() * colorArray.length)];
        };

        // ============================================
        // ERROR BOUNDARY COMPONENT
        // ============================================
        
        class ErrorBoundary extends React.Component {
            constructor(props) {
                super(props);
                this.state = { hasError: false, error: null };
            }

            static getDerivedStateFromError(error) {
                return { hasError: true, error };
            }

            componentDidCatch(error, errorInfo) {
                console.error('Game Error:', error, errorInfo);
            }

            render() {
                if (this.state.hasError) {
                    return (
                        <div className="error-fallback">
                            <h1 style={{ fontSize: '3rem', marginBottom: '1rem' }}>⚠️</h1>
                            <h2 style={{ fontSize: '1.5rem', marginBottom: '1rem' }}>Game Error</h2>
                            <p style={{ marginBottom: '2rem', color: '#999' }}>
                                Something went wrong. Please refresh the page.
                            </p>
                            <button
                                onClick={() => window.location.reload()}
                                style={{
                                    background: '#00E5FF',
                                    color: '#121212',
                                    padding: '12px 24px',
                                    border: 'none',
                                    borderRadius: '8px',
                                    fontWeight: 'bold',
                                    cursor: 'pointer',
                                    fontFamily: 'inherit'
                                }}
                            >
                                RELOAD GAME
                            </button>
                        </div>
                    );
                }

                return this.props.children;
            }
        }

        // ============================================
        // HANGMAN DRAWING COMPONENT
        // ============================================

        const HangmanDrawing = ({ wrongGuesses, settings, currentColors, figureType, isReverse }) => {
            const maxMistakes = settings.extendedMode ? GAME_CONFIG.extendedMaxMistakes : GAME_CONFIG.standardMaxMistakes;
            const effectiveWrongGuesses = isReverse ? (maxMistakes - wrongGuesses) : wrongGuesses;

            const FigureComponents = {
                classic: ClassicFigure,
                man: ManFigure,
                woman: WomanFigure,
                cat: CatFigure,
                dog: DogFigure,
                elephant: ElephantFigure,
                pig: PigFigure,
                horse: HorseFigure,
                chicken: ChickenFigure,
                alien: AlienFigure
            };

            const FigureComponent = FigureComponents[figureType] || ClassicFigure;

            return (
                <svg 
                    viewBox="0 0 200 200"
                    width="280" 
                    height="280"
                    className="overflow-visible"
                    role="img"
                    aria-label={`Hangman figure with ${wrongGuesses} wrong guesses`}
                >
                    {settings.showGallows && (
                        <g>
                            {/* Base */}
                            <path
                                d="M20 185 Q100 190 180 185"
                                fill="none"
                                stroke="#5D4E37"
                                strokeWidth="8"
                                strokeLinecap="round"
                            />
                            {/* Vertical post */}
                            <path
                                d="M40 185 Q38 100 40 25"
                                fill="none"
                                stroke="#6B5B45"
                                strokeWidth="6"
                                strokeLinecap="round"
                            />
                            {/* Horizontal beam */}
                            <path
                                d="M40 25 Q70 23 100 25"
                                fill="none"
                                stroke="#6B5B45"
                                strokeWidth="6"
                                strokeLinecap="round"
                            />
                            {/* Rope */}
                            <path
                                d="M100 25 Q102 30 100 40"
                                fill="none"
                                stroke="#8B7355"
                                strokeWidth="3"
                                strokeLinecap="round"
                            />
                            {/* Wood grain details */}
                            <path d="M38 60 Q40 65 38 70" fill="none" stroke="#4A3C2A" strokeWidth="1" opacity="0.5" />
                            <path d="M42 100 Q44 105 42 110" fill="none" stroke="#4A3C2A" strokeWidth="1" opacity="0.5" />
                        </g>
                    )}
                    <FigureComponent 
                        wrongGuesses={isReverse ? effectiveWrongGuesses : wrongGuesses}
                        colors={currentColors}
                        extendedMode={settings.extendedMode}
                    />
                </svg>
            );
        };

        // ============================================
        // CLASSIC STICK FIGURE (6 parts only)
        // ============================================
        const ClassicFigure = ({ wrongGuesses, colors }) => {
            const strokeColor = colors.figure || "#00E5FF";
            
            return (
                <g transform="translate(100, 45)">
                    {/* 1. Head */}
                    {wrongGuesses >= 1 && (
                        <circle 
                            cx="0" cy="15" r="15" 
                            fill="none" 
                            stroke={strokeColor} 
                            strokeWidth="4" 
                            strokeLinecap="round"
                            className="neon-stroke"
                        />
                    )}
                    
                    {/* 2. Body */}
                    {wrongGuesses >= 2 && (
                        <path 
                            d="M0 30 Q0 60 0 90" 
                            fill="none" 
                            stroke={strokeColor} 
                            strokeWidth="4" 
                            strokeLinecap="round"
                            className="neon-stroke"
                        />
                    )}
                    
                    {/* 3. Left Arm */}
                    {wrongGuesses >= 3 && (
                        <path 
                            d="M0 45 Q-15 55 -30 65" 
                            fill="none" 
                            stroke={strokeColor} 
                            strokeWidth="4" 
                            strokeLinecap="round"
                            className="neon-stroke"
                        />
                    )}
                    
                    {/* 4. Right Arm */}
                    {wrongGuesses >= 4 && (
                        <path 
                            d="M0 45 Q15 55 30 65" 
                            fill="none" 
                            stroke={strokeColor} 
                            strokeWidth="4" 
                            strokeLinecap="round"
                            className="neon-stroke"
                        />
                    )}
                    
                    {/* 5. Left Leg */}
                    {wrongGuesses >= 5 && (
                        <path 
                            d="M0 90 Q-12 110 -25 130" 
                            fill="none" 
                            stroke={strokeColor} 
                            strokeWidth="4" 
                            strokeLinecap="round"
                            className="neon-stroke"
                        />
                    )}
                    
                    {/* 6. Right Leg */}
                    {wrongGuesses >= 6 && (
                        <path 
                            d="M0 90 Q12 110 25 130" 
                            fill="none" 
                            stroke={strokeColor} 
                            strokeWidth="4" 
                            strokeLinecap="round"
                            className="neon-stroke"
                        />
                    )}
                </g>
            );
        };

        // ============================================
        // MAN FIGURE (20 parts)
        // ============================================
        const ManFigure = ({ wrongGuesses, colors, extendedMode }) => {
            const strokeColor = colors.figure || "#00E5FF";
            const skinColor = "#FFD5B8";
            const shirtColor = colors.clothing || "#4ECDC4";
            const pantsColor = "#2C3E50";
            const hairColor = colors.facialHair || "#4A3728";
            const eyeColor = colors.eyes || "#4A90E2";
            const isDefeated = wrongGuesses >= 6;

            return (
                <g transform="translate(100, 45)">
                    {/* 2. Body/Torso - rendered first so head appears on top */}
                    {wrongGuesses >= 2 && (
                        <path 
                            d="M0 36 Q0 65 0 95" 
                            fill="none" 
                            stroke={extendedMode ? shirtColor : strokeColor} 
                            strokeWidth={extendedMode ? "20" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 1. Head (oval outline) - rendered after torso so it appears on top */}
                    {wrongGuesses >= 1 && (
                        <ellipse 
                            cx="0" cy="18" rx="16" ry="18" 
                            fill={extendedMode ? skinColor : "none"} 
                            stroke={strokeColor} 
                            strokeWidth="4" 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 3. Left Arm */}
                    {wrongGuesses >= 3 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M0 50 Q-18 70 -25 90"
                                : "M0 50 Q-20 55 -35 70"
                            }
                            fill="none" 
                            stroke={extendedMode ? shirtColor : strokeColor} 
                            strokeWidth={extendedMode ? "10" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 4. Right Arm */}
                    {wrongGuesses >= 4 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M0 50 Q18 70 25 90"
                                : "M0 50 Q20 55 35 70"
                            }
                            fill="none" 
                            stroke={extendedMode ? shirtColor : strokeColor} 
                            strokeWidth={extendedMode ? "10" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 5. Left Leg */}
                    {wrongGuesses >= 5 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M0 95 Q-15 115 -20 140"
                                : "M0 95 Q-12 115 -18 140"
                            }
                            fill="none" 
                            stroke={extendedMode ? pantsColor : strokeColor} 
                            strokeWidth={extendedMode ? "12" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 6. Right Leg */}
                    {wrongGuesses >= 6 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M0 95 Q15 115 20 140"
                                : "M0 95 Q12 115 18 140"
                            }
                            fill="none" 
                            stroke={extendedMode ? pantsColor : strokeColor} 
                            strokeWidth={extendedMode ? "12" : "4"} 
                            strokeLinecap="round"
                        />
                    )}

                    {/* Extended mode details (7-20) */}
                    {extendedMode && (
                        <>
                            {/* 7. Left Eye */}
                            {wrongGuesses >= 7 && (
                                <g>
                                    <ellipse cx="-6" cy="14" rx="3" ry="4" fill="white" />
                                    {!isDefeated ? (
                                        <>
                                            <circle cx="-5" cy="15" r="2" fill={eyeColor} />
                                            <circle cx="-4" cy="14" r="0.8" fill="white" />
                                        </>
                                    ) : (
                                        <g stroke="#555" strokeWidth="2" strokeLinecap="round">
                                            <line x1="-8" y1="12" x2="-4" y2="18" />
                                            <line x1="-4" y1="12" x2="-8" y2="18" />
                                        </g>
                                    )}
                                </g>
                            )}
                            
                            {/* 8. Right Eye */}
                            {wrongGuesses >= 8 && (
                                <g>
                                    <ellipse cx="6" cy="14" rx="3" ry="4" fill="white" />
                                    {!isDefeated ? (
                                        <>
                                            <circle cx="7" cy="15" r="2" fill={eyeColor} />
                                            <circle cx="8" cy="14" r="0.8" fill="white" />
                                        </>
                                    ) : (
                                        <g stroke="#555" strokeWidth="2" strokeLinecap="round">
                                            <line x1="4" y1="12" x2="8" y2="18" />
                                            <line x1="8" y1="12" x2="4" y2="18" />
                                        </g>
                                    )}
                                </g>
                            )}
                            
                            {/* 9. Nose */}
                            {wrongGuesses >= 9 && (
                                <path 
                                    d="M0 18 Q2 22 0 26" 
                                    fill="none" 
                                    stroke="#E8BFA0" 
                                    strokeWidth="2" 
                                    strokeLinecap="round"
                                />
                            )}
                            
                            {/* 10. Mouth */}
                            {wrongGuesses >= 10 && (
                                <path 
                                    d={isDefeated ? "M-5 30 Q0 26 5 30" : "M-5 30 Q0 34 5 30"} 
                                    fill="none" 
                                    stroke="#D4756A" 
                                    strokeWidth="2" 
                                    strokeLinecap="round"
                                />
                            )}
                            
                            {/* 11. Hair */}
                            {wrongGuesses >= 11 && (
                                <path
                                    d="M-14 8 Q-16 -2 -8 -5 Q0 -7 8 -5 Q16 -2 14 8 Q12 5 8 4 Q0 3 -8 4 Q-12 5 -14 8"
                                    fill={hairColor}
                                />
                            )}
                            
                            {/* 12. Left Eyebrow */}
                            {wrongGuesses >= 12 && (
                                <path 
                                    d="M-10 8 Q-6 6 -2 8" 
                                    fill="none" 
                                    stroke={hairColor} 
                                    strokeWidth="2" 
                                    strokeLinecap="round"
                                />
                            )}
                            
                            {/* 13. Right Eyebrow */}
                            {wrongGuesses >= 13 && (
                                <path 
                                    d="M2 8 Q6 6 10 8" 
                                    fill="none" 
                                    stroke={hairColor} 
                                    strokeWidth="2" 
                                    strokeLinecap="round"
                                />
                            )}
                            
                            {/* 14. Left Hand */}
                            {wrongGuesses >= 14 && (
                                <circle 
                                    cx={isDefeated ? "-25" : "-35"} 
                                    cy={isDefeated ? "93" : "73"} 
                                    r="6" 
                                    fill={skinColor} 
                                />
                            )}
                            
                            {/* 15. Right Hand */}
                            {wrongGuesses >= 15 && (
                                <circle 
                                    cx={isDefeated ? "25" : "35"} 
                                    cy={isDefeated ? "93" : "73"} 
                                    r="6" 
                                    fill={skinColor} 
                                />
                            )}
                            
                            {/* 16. Left Shoe */}
                            {wrongGuesses >= 16 && (
                                <ellipse 
                                    cx={isDefeated ? "-20" : "-18"} 
                                    cy="145" 
                                    rx="8" ry="5" 
                                    fill="#2C2C2C" 
                                />
                            )}
                            
                            {/* 17. Right Shoe */}
                            {wrongGuesses >= 17 && (
                                <ellipse 
                                    cx={isDefeated ? "20" : "18"} 
                                    cy="145" 
                                    rx="8" ry="5" 
                                    fill="#2C2C2C" 
                                />
                            )}
                            
                            {/* 18. Left Ear */}
                            {wrongGuesses >= 18 && (
                                <ellipse cx="-15" cy="18" rx="3" ry="5" fill={skinColor} />
                            )}
                            
                            {/* 19. Right Ear */}
                            {wrongGuesses >= 19 && (
                                <ellipse cx="15" cy="18" rx="3" ry="5" fill={skinColor} />
                            )}
                            
                            {/* 20. Shirt Collar/Detail */}
                            {wrongGuesses >= 20 && (
                                <g>
                                    <path d="M-8 36 Q0 42 8 36" fill="none" stroke="#3DB8A9" strokeWidth="3" strokeLinecap="round" />
                                    <rect x="-3" y="50" width="6" height="8" rx="1" fill="#3DB8A9" opacity="0.7" />
                                </g>
                            )}
                        </>
                    )}
                </g>
            );
        };

        // ============================================
        // WOMAN FIGURE (20 parts)
        // ============================================
        const WomanFigure = ({ wrongGuesses, colors, extendedMode }) => {
            const strokeColor = colors.figure || "#00E5FF";
            const skinColor = "#FFE4D0";
            const dressColor = colors.clothing || "#FF6B9D";
            const hairColor = colors.facialHair || "#8B4513";
            const eyeColor = colors.eyes || "#2ECC71";
            const isDefeated = wrongGuesses >= 6;

            return (
                <g transform="translate(100, 45)">
                    {/* 1. Head */}
                    {wrongGuesses >= 1 && (
                        <ellipse 
                            cx="0" cy="16" rx="14" ry="17" 
                            fill={extendedMode ? skinColor : "none"} 
                            stroke={strokeColor} 
                            strokeWidth="4" 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 2. Body/Dress */}
                    {wrongGuesses >= 2 && (
                        <path 
                            d={extendedMode 
                                ? "M-12 33 Q-18 60 -22 95 L22 95 Q18 60 12 33 Q0 30 -12 33"
                                : "M0 33 Q0 60 0 95"
                            }
                            fill={extendedMode ? dressColor : "none"} 
                            stroke={extendedMode ? dressColor : strokeColor} 
                            strokeWidth="4" 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 3. Left Arm */}
                    {wrongGuesses >= 3 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M-12 40 Q-22 60 -25 85"
                                : "M-12 40 Q-25 50 -32 70"
                            }
                            fill="none" 
                            stroke={extendedMode ? skinColor : strokeColor} 
                            strokeWidth={extendedMode ? "8" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 4. Right Arm */}
                    {wrongGuesses >= 4 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M12 40 Q22 60 25 85"
                                : "M12 40 Q25 50 32 70"
                            }
                            fill="none" 
                            stroke={extendedMode ? skinColor : strokeColor} 
                            strokeWidth={extendedMode ? "8" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 5. Left Leg */}
                    {wrongGuesses >= 5 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M-8 95 Q-15 115 -18 140"
                                : "M-8 95 Q-10 115 -10 140"
                            }
                            fill="none" 
                            stroke={extendedMode ? skinColor : strokeColor} 
                            strokeWidth={extendedMode ? "8" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 6. Right Leg */}
                    {wrongGuesses >= 6 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M8 95 Q15 115 18 140"
                                : "M8 95 Q10 115 10 140"
                            }
                            fill="none" 
                            stroke={extendedMode ? skinColor : strokeColor} 
                            strokeWidth={extendedMode ? "8" : "4"} 
                            strokeLinecap="round"
                        />
                    )}

                    {/* Extended mode details (7-20) */}
                    {extendedMode && (
                        <>
                            {/* 7. Left Eye */}
                            {wrongGuesses >= 7 && (
                                <g>
                                    <ellipse cx="-5" cy="12" rx="3" ry="4" fill="white" />
                                    {!isDefeated ? (
                                        <>
                                            <circle cx="-4" cy="13" r="2" fill={eyeColor} />
                                            <circle cx="-3" cy="12" r="0.7" fill="white" />
                                        </>
                                    ) : (
                                        <g stroke="#555" strokeWidth="2" strokeLinecap="round">
                                            <line x1="-7" y1="10" x2="-3" y2="16" />
                                            <line x1="-3" y1="10" x2="-7" y2="16" />
                                        </g>
                                    )}
                                </g>
                            )}
                            
                            {/* 8. Right Eye */}
                            {wrongGuesses >= 8 && (
                                <g>
                                    <ellipse cx="5" cy="12" rx="3" ry="4" fill="white" />
                                    {!isDefeated ? (
                                        <>
                                            <circle cx="6" cy="13" r="2" fill={eyeColor} />
                                            <circle cx="7" cy="12" r="0.7" fill="white" />
                                        </>
                                    ) : (
                                        <g stroke="#555" strokeWidth="2" strokeLinecap="round">
                                            <line x1="3" y1="10" x2="7" y2="16" />
                                            <line x1="7" y1="10" x2="3" y2="16" />
                                        </g>
                                    )}
                                </g>
                            )}
                            
                            {/* 9. Nose */}
                            {wrongGuesses >= 9 && (
                                <path 
                                    d="M0 16 Q1 19 0 22" 
                                    fill="none" 
                                    stroke="#E8CDB8" 
                                    strokeWidth="1.5" 
                                    strokeLinecap="round"
                                />
                            )}
                            
                            {/* 10. Mouth/Lips */}
                            {wrongGuesses >= 10 && (
                                <g>
                                    <path 
                                        d={isDefeated ? "M-4 26 Q0 22 4 26" : "M-4 26 Q0 29 4 26"} 
                                        fill={isDefeated ? "none" : "#E88B9C"}
                                        stroke="#E88B9C" 
                                        strokeWidth="1.5" 
                                        strokeLinecap="round"
                                    />
                                </g>
                            )}
                            
                            {/* 11. Hair */}
                            {wrongGuesses >= 11 && (
                                <path
                                    d="M-16 8 Q-18 -4 -6 -8 Q5 -10 14 -6 Q20 0 18 12 Q20 25 18 40 L15 40 Q16 28 15 15 Q14 8 8 5 Q0 3 -8 5 Q-14 8 -15 15 Q-16 28 -15 40 L-18 40 Q-20 25 -16 8"
                                    fill={hairColor}
                                />
                            )}
                            
                            {/* 12. Left Eyelash */}
                            {wrongGuesses >= 12 && (
                                <path d="M-8 9 Q-6 7 -4 8" fill="none" stroke="#333" strokeWidth="1.5" strokeLinecap="round" />
                            )}
                            
                            {/* 13. Right Eyelash */}
                            {wrongGuesses >= 13 && (
                                <path d="M4 8 Q6 7 8 9" fill="none" stroke="#333" strokeWidth="1.5" strokeLinecap="round" />
                            )}
                            
                            {/* 14. Left Hand */}
                            {wrongGuesses >= 14 && (
                                <circle 
                                    cx={isDefeated ? "-25" : "-32"} 
                                    cy={isDefeated ? "88" : "73"} 
                                    r="5" 
                                    fill={skinColor} 
                                />
                            )}
                            
                            {/* 15. Right Hand */}
                            {wrongGuesses >= 15 && (
                                <circle 
                                    cx={isDefeated ? "25" : "32"} 
                                    cy={isDefeated ? "88" : "73"} 
                                    r="5" 
                                    fill={skinColor} 
                                />
                            )}
                            
                            {/* 16. Left Shoe/Heel */}
                            {wrongGuesses >= 16 && (
                                <g>
                                    <ellipse cx={isDefeated ? "-18" : "-10"} cy="145" rx="7" ry="4" fill="#E85A8A" />
                                    <rect x={isDefeated ? "-16" : "-8"} y="147" width="3" height="4" fill="#E85A8A" />
                                </g>
                            )}
                            
                            {/* 17. Right Shoe/Heel */}
                            {wrongGuesses >= 17 && (
                                <g>
                                    <ellipse cx={isDefeated ? "18" : "10"} cy="145" rx="7" ry="4" fill="#E85A8A" />
                                    <rect x={isDefeated ? "15" : "7"} y="147" width="3" height="4" fill="#E85A8A" />
                                </g>
                            )}
                            
                            {/* 18. Left Earring */}
                            {wrongGuesses >= 18 && (
                                <circle cx="-13" cy="22" r="2" fill="#FFD700" />
                            )}
                            
                            {/* 19. Right Earring */}
                            {wrongGuesses >= 19 && (
                                <circle cx="13" cy="22" r="2" fill="#FFD700" />
                            )}
                            
                            {/* 20. Blush/Cheeks */}
                            {wrongGuesses >= 20 && (
                                <g>
                                    <ellipse cx="-9" cy="20" rx="3" ry="2" fill="#FFB6C1" opacity="0.5" />
                                    <ellipse cx="9" cy="20" rx="3" ry="2" fill="#FFB6C1" opacity="0.5" />
                                </g>
                            )}
                        </>
                    )}
                </g>
            );
        };

        // ============================================
        // CAT FIGURE (20 parts)
        // ============================================
        const CatFigure = ({ wrongGuesses, colors, extendedMode }) => {
            const strokeColor = colors.figure || "#00E5FF";
            const furColor = colors.clothing || "#FF9F43";
            const furDark = "#E8873A";
            const furLight = "#FFB366";
            const eyeColor = colors.eyes || "#2ECC71";
            const isDefeated = wrongGuesses >= 6;

            return (
                <g transform="translate(100, 50)">
                    {/* 1. Head */}
                    {wrongGuesses >= 1 && (
                        <circle 
                            cx="0" cy="20" r="20" 
                            fill={extendedMode ? furColor : "none"} 
                            stroke={strokeColor} 
                            strokeWidth="4" 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 2. Body */}
                    {wrongGuesses >= 2 && (
                        <ellipse 
                            cx="0" cy="75" rx="25" ry="30" 
                            fill={extendedMode ? furColor : "none"} 
                            stroke={strokeColor} 
                            strokeWidth="4" 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 3. Front Left Leg */}
                    {wrongGuesses >= 3 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M-15 95 Q-22 110 -25 130"
                                : "M-15 95 Q-18 110 -15 130"
                            }
                            fill="none" 
                            stroke={extendedMode ? furColor : strokeColor} 
                            strokeWidth={extendedMode ? "10" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 4. Front Right Leg */}
                    {wrongGuesses >= 4 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M15 95 Q22 110 25 130"
                                : "M15 95 Q18 110 15 130"
                            }
                            fill="none" 
                            stroke={extendedMode ? furColor : strokeColor} 
                            strokeWidth={extendedMode ? "10" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 5. Back Left Leg */}
                    {wrongGuesses >= 5 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M-20 90 Q-30 105 -35 125"
                                : "M-20 90 Q-28 100 -30 115"
                            }
                            fill="none" 
                            stroke={extendedMode ? furColor : strokeColor} 
                            strokeWidth={extendedMode ? "10" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 6. Back Right Leg */}
                    {wrongGuesses >= 6 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M20 90 Q30 105 35 125"
                                : "M20 90 Q28 100 30 115"
                            }
                            fill="none" 
                            stroke={extendedMode ? furColor : strokeColor} 
                            strokeWidth={extendedMode ? "10" : "4"} 
                            strokeLinecap="round"
                        />
                    )}

                    {/* Extended mode details (7-20) */}
                    {extendedMode && (
                        <>
                            {/* 7. Left Eye */}
                            {wrongGuesses >= 7 && (
                                <g>
                                    <ellipse cx="-8" cy="16" rx="4" ry="6" fill="white" />
                                    {!isDefeated ? (
                                        <>
                                            <ellipse cx="-7" cy="17" rx="2" ry="4" fill={eyeColor} />
                                            <ellipse cx="-7" cy="17" rx="1" ry="3" fill="#1a1a1a" />
                                            <circle cx="-5" cy="14" r="1.2" fill="white" />
                                        </>
                                    ) : (
                                        <g stroke="#333" strokeWidth="2" strokeLinecap="round">
                                            <line x1="-11" y1="13" x2="-5" y2="21" />
                                            <line x1="-5" y1="13" x2="-11" y2="21" />
                                        </g>
                                    )}
                                </g>
                            )}
                            
                            {/* 8. Right Eye */}
                            {wrongGuesses >= 8 && (
                                <g>
                                    <ellipse cx="8" cy="16" rx="4" ry="6" fill="white" />
                                    {!isDefeated ? (
                                        <>
                                            <ellipse cx="9" cy="17" rx="2" ry="4" fill={eyeColor} />
                                            <ellipse cx="9" cy="17" rx="1" ry="3" fill="#1a1a1a" />
                                            <circle cx="11" cy="14" r="1.2" fill="white" />
                                        </>
                                    ) : (
                                        <g stroke="#333" strokeWidth="2" strokeLinecap="round">
                                            <line x1="5" y1="13" x2="11" y2="21" />
                                            <line x1="11" y1="13" x2="5" y2="21" />
                                        </g>
                                    )}
                                </g>
                            )}
                            
                            {/* 9. Nose */}
                            {wrongGuesses >= 9 && (
                                <path d="M-3 26 L0 23 L3 26 L0 28 Z" fill="#FFB6C1" />
                            )}
                            
                            {/* 10. Mouth */}
                            {wrongGuesses >= 10 && (
                                <g>
                                    <path d="M0 28 L0 32" stroke="#333" strokeWidth="1.5" strokeLinecap="round" />
                                    <path 
                                        d={isDefeated ? "M-5 34 Q0 30 5 34" : "M0 32 Q-4 36 -7 34"} 
                                        fill="none" 
                                        stroke="#333" 
                                        strokeWidth="1.5" 
                                        strokeLinecap="round"
                                    />
                                    {!isDefeated && <path d="M0 32 Q4 36 7 34" fill="none" stroke="#333" strokeWidth="1.5" strokeLinecap="round" />}
                                </g>
                            )}
                            
                            {/* 11. Left Ear */}
                            {wrongGuesses >= 11 && (
                                <g>
                                    <path d="M-18 8 L-12 -8 L-4 5 Z" fill={furColor} stroke={furDark} strokeWidth="2" />
                                    <path d="M-14 5 L-11 -3 L-7 4 Z" fill="#FFB6C1" opacity="0.6" />
                                </g>
                            )}
                            
                            {/* 12. Right Ear */}
                            {wrongGuesses >= 12 && (
                                <g>
                                    <path d="M18 8 L12 -8 L4 5 Z" fill={furColor} stroke={furDark} strokeWidth="2" />
                                    <path d="M14 5 L11 -3 L7 4 Z" fill="#FFB6C1" opacity="0.6" />
                                </g>
                            )}
                            
                            {/* 13. Tail */}
                            {wrongGuesses >= 13 && (
                                <path
                                    d={isDefeated 
                                        ? "M22 65 Q35 70 38 85 Q40 95 35 100"
                                        : "M22 65 Q40 55 45 40 Q48 30 44 25"
                                    }
                                    fill="none"
                                    stroke={furColor}
                                    strokeWidth="8"
                                    strokeLinecap="round"
                                />
                            )}
                            
                            {/* 14. Left Front Paw */}
                            {wrongGuesses >= 14 && (
                                <g>
                                    <ellipse cx={isDefeated ? "-25" : "-15"} cy={isDefeated ? "133" : "133"} rx="7" ry="4" fill={furColor} />
                                    <circle cx={isDefeated ? "-29" : "-19"} cy={isDefeated ? "132" : "132"} r="1.5" fill={furDark} />
                                    <circle cx={isDefeated ? "-25" : "-15"} cy={isDefeated ? "134" : "134"} r="1.5" fill={furDark} />
                                    <circle cx={isDefeated ? "-21" : "-11"} cy={isDefeated ? "132" : "132"} r="1.5" fill={furDark} />
                                </g>
                            )}
                            
                            {/* 15. Right Front Paw */}
                            {wrongGuesses >= 15 && (
                                <g>
                                    <ellipse cx={isDefeated ? "25" : "15"} cy={isDefeated ? "133" : "133"} rx="7" ry="4" fill={furColor} />
                                    <circle cx={isDefeated ? "21" : "11"} cy={isDefeated ? "132" : "132"} r="1.5" fill={furDark} />
                                    <circle cx={isDefeated ? "25" : "15"} cy={isDefeated ? "134" : "134"} r="1.5" fill={furDark} />
                                    <circle cx={isDefeated ? "29" : "19"} cy={isDefeated ? "132" : "132"} r="1.5" fill={furDark} />
                                </g>
                            )}
                            
                            {/* 16. Left Whiskers */}
                            {wrongGuesses >= 16 && (
                                <g stroke={isDefeated ? "#666" : "#333"} strokeWidth="1" strokeLinecap="round">
                                    <line x1="-12" y1="24" x2="-25" y2={isDefeated ? "28" : "22"} />
                                    <line x1="-12" y1="28" x2="-25" y2={isDefeated ? "32" : "28"} />
                                    <line x1="-12" y1="32" x2="-25" y2={isDefeated ? "38" : "34"} />
                                </g>
                            )}
                            
                            {/* 17. Right Whiskers */}
                            {wrongGuesses >= 17 && (
                                <g stroke={isDefeated ? "#666" : "#333"} strokeWidth="1" strokeLinecap="round">
                                    <line x1="12" y1="24" x2="25" y2={isDefeated ? "28" : "22"} />
                                    <line x1="12" y1="28" x2="25" y2={isDefeated ? "32" : "28"} />
                                    <line x1="12" y1="32" x2="25" y2={isDefeated ? "38" : "34"} />
                                </g>
                            )}
                            
                            {/* 18. Belly patch */}
                            {wrongGuesses >= 18 && (
                                <ellipse cx="0" cy="80" rx="15" ry="20" fill={furLight} opacity="0.6" />
                            )}
                            
                            {/* 19. Stripes */}
                            {wrongGuesses >= 19 && (
                                <g stroke={furDark} strokeWidth="3" strokeLinecap="round" opacity="0.6">
                                    <path d="M-8 55 Q0 58 8 55" fill="none" />
                                    <path d="M-10 65 Q0 68 10 65" fill="none" />
                                    <path d="M-8 75 Q0 78 8 75" fill="none" />
                                </g>
                            )}
                            
                            {/* 20. Cheek fluff */}
                            {wrongGuesses >= 20 && (
                                <g fill={furLight}>
                                    <path d="M-20 22 Q-24 25 -22 30 Q-18 27 -16 24 Z" />
                                    <path d="M20 22 Q24 25 22 30 Q18 27 16 24 Z" />
                                </g>
                            )}
                        </>
                    )}
                </g>
            );
        };

        // ============================================
        // DOG FIGURE (20 parts)
        // ============================================
        const DogFigure = ({ wrongGuesses, colors, extendedMode }) => {
            const strokeColor = colors.figure || "#00E5FF";
            const furColor = colors.clothing || "#D4A574";
            const furDark = "#B8956A";
            const furLight = "#E8C49A";
            const eyeColor = colors.eyes || "#4A3728";
            const isDefeated = wrongGuesses >= 6;

            return (
                <g transform="translate(100, 45)">
                    {/* 1. Head */}
                    {wrongGuesses >= 1 && (
                        <ellipse 
                            cx="0" cy="22" rx="22" ry="20" 
                            fill={extendedMode ? furColor : "none"} 
                            stroke={strokeColor} 
                            strokeWidth="4" 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 2. Body */}
                    {wrongGuesses >= 2 && (
                        <ellipse 
                            cx="0" cy="80" rx="28" ry="32" 
                            fill={extendedMode ? furColor : "none"} 
                            stroke={strokeColor} 
                            strokeWidth="4" 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 3. Front Left Leg */}
                    {wrongGuesses >= 3 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M-15 100 Q-22 118 -25 138"
                                : "M-15 100 Q-17 118 -15 138"
                            }
                            fill="none" 
                            stroke={extendedMode ? furColor : strokeColor} 
                            strokeWidth={extendedMode ? "12" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 4. Front Right Leg */}
                    {wrongGuesses >= 4 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M15 100 Q22 118 25 138"
                                : "M15 100 Q17 118 15 138"
                            }
                            fill="none" 
                            stroke={extendedMode ? furColor : strokeColor} 
                            strokeWidth={extendedMode ? "12" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 5. Back Left Leg */}
                    {wrongGuesses >= 5 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M-22 95 Q-32 110 -35 130"
                                : "M-22 95 Q-28 108 -28 125"
                            }
                            fill="none" 
                            stroke={extendedMode ? furColor : strokeColor} 
                            strokeWidth={extendedMode ? "12" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 6. Back Right Leg */}
                    {wrongGuesses >= 6 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M22 95 Q32 110 35 130"
                                : "M22 95 Q28 108 28 125"
                            }
                            fill="none" 
                            stroke={extendedMode ? furColor : strokeColor} 
                            strokeWidth={extendedMode ? "12" : "4"} 
                            strokeLinecap="round"
                        />
                    )}

                    {/* Extended mode details (7-20) */}
                    {extendedMode && (
                        <>
                            {/* 7. Left Eye */}
                            {wrongGuesses >= 7 && (
                                <g>
                                    <ellipse cx="-8" cy="18" rx="4" ry="5" fill="white" />
                                    {!isDefeated ? (
                                        <>
                                            <circle cx="-7" cy="19" r="3" fill={eyeColor} />
                                            <circle cx="-5" cy="17" r="1.2" fill="white" />
                                        </>
                                    ) : (
                                        <g stroke="#333" strokeWidth="2" strokeLinecap="round">
                                            <line x1="-11" y1="15" x2="-5" y2="23" />
                                            <line x1="-5" y1="15" x2="-11" y2="23" />
                                        </g>
                                    )}
                                </g>
                            )}
                            
                            {/* 8. Right Eye */}
                            {wrongGuesses >= 8 && (
                                <g>
                                    <ellipse cx="8" cy="18" rx="4" ry="5" fill="white" />
                                    {!isDefeated ? (
                                        <>
                                            <circle cx="9" cy="19" r="3" fill={eyeColor} />
                                            <circle cx="11" cy="17" r="1.2" fill="white" />
                                        </>
                                    ) : (
                                        <g stroke="#333" strokeWidth="2" strokeLinecap="round">
                                            <line x1="5" y1="15" x2="11" y2="23" />
                                            <line x1="11" y1="15" x2="5" y2="23" />
                                        </g>
                                    )}
                                </g>
                            )}
                            
                            {/* 9. Snout/Nose */}
                            {wrongGuesses >= 9 && (
                                <g>
                                    <ellipse cx="0" cy="32" rx="10" ry="8" fill={furLight} />
                                    <ellipse cx="0" cy="30" rx="5" ry="4" fill="#2C2C2C" />
                                    <ellipse cx="-2" cy="29" rx="1.5" ry="1" fill="#555" opacity="0.5" />
                                </g>
                            )}
                            
                            {/* 10. Mouth/Tongue */}
                            {wrongGuesses >= 10 && (
                                <g>
                                    <path d="M-6 36 Q0 40 6 36" fill="none" stroke="#333" strokeWidth="1.5" strokeLinecap="round" />
                                    {!isDefeated && (
                                        <path d="M-2 38 Q0 48 2 38 Q3 45 0 50 Q-3 45 -2 38" fill="#FF8B9A" />
                                    )}
                                    {isDefeated && (
                                        <path d="M-5 38 Q0 34 5 38" fill="none" stroke="#333" strokeWidth="1.5" strokeLinecap="round" />
                                    )}
                                </g>
                            )}
                            
                            {/* 11. Left Ear (floppy) */}
                            {wrongGuesses >= 11 && (
                                <path
                                    d="M-20 12 Q-28 8 -32 18 Q-35 32 -28 42 Q-23 44 -18 38 Q-16 28 -18 18 Z"
                                    fill={furDark}
                                />
                            )}
                            
                            {/* 12. Right Ear (floppy) */}
                            {wrongGuesses >= 12 && (
                                <path
                                    d="M20 12 Q28 8 32 18 Q35 32 28 42 Q23 44 18 38 Q16 28 18 18 Z"
                                    fill={furDark}
                                />
                            )}
                            
                            {/* 13. Tail */}
                            {wrongGuesses >= 13 && (
                                <path
                                    d={isDefeated 
                                        ? "M25 70 Q38 78 40 95 Q42 105 38 110"
                                        : "M25 70 Q48 60 52 45 Q55 35 50 30"
                                    }
                                    fill="none"
                                    stroke={furColor}
                                    strokeWidth="10"
                                    strokeLinecap="round"
                                />
                            )}
                            
                            {/* 14. Front Left Paw */}
                            {wrongGuesses >= 14 && (
                                <ellipse 
                                    cx={isDefeated ? "-25" : "-15"} 
                                    cy="142" 
                                    rx="8" ry="5" 
                                    fill={furDark} 
                                />
                            )}
                            
                            {/* 15. Front Right Paw */}
                            {wrongGuesses >= 15 && (
                                <ellipse 
                                    cx={isDefeated ? "25" : "15"} 
                                    cy="142" 
                                    rx="8" ry="5" 
                                    fill={furDark} 
                                />
                            )}
                            
                            {/* 16. Back Left Paw */}
                            {wrongGuesses >= 16 && (
                                <ellipse 
                                    cx={isDefeated ? "-35" : "-28"} 
                                    cy={isDefeated ? "134" : "129"} 
                                    rx="8" ry="5" 
                                    fill={furDark} 
                                />
                            )}
                            
                            {/* 17. Back Right Paw */}
                            {wrongGuesses >= 17 && (
                                <ellipse 
                                    cx={isDefeated ? "35" : "28"} 
                                    cy={isDefeated ? "134" : "129"} 
                                    rx="8" ry="5" 
                                    fill={furDark} 
                                />
                            )}
                            
                            {/* 18. Collar */}
                            {wrongGuesses >= 18 && (
                                <g>
                                    <ellipse cx="0" cy="48" rx="16" ry="5" fill="#E74C3C" />
                                    <circle cx="0" cy="52" r="3" fill="#F4D03F" />
                                </g>
                            )}
                            
                            {/* 19. Belly patch */}
                            {wrongGuesses >= 19 && (
                                <ellipse cx="0" cy="85" rx="18" ry="20" fill={furLight} opacity="0.5" />
                            )}
                            
                            {/* 20. Spots */}
                            {wrongGuesses >= 20 && (
                                <g fill={furDark} opacity="0.6">
                                    <ellipse cx="-12" cy="70" rx="7" ry="5" />
                                    <ellipse cx="10" cy="85" rx="5" ry="7" />
                                    <circle cx="5" cy="60" r="4" />
                                </g>
                            )}
                        </>
                    )}
                </g>
            );
        };

        // ============================================
        // ELEPHANT FIGURE (20 parts)
        // ============================================
        const ElephantFigure = ({ wrongGuesses, colors, extendedMode }) => {
            const strokeColor = colors.figure || "#00E5FF";
            const bodyColor = colors.clothing || "#A0A0A0";
            const bodyDark = "#808080";
            const bodyLight = "#C0C0C0";
            const earInner = "#FFB6C1";
            const eyeColor = colors.eyes || "#4A3728";
            const isDefeated = wrongGuesses >= 6;

            return (
                <g transform="translate(100, 35)">
                    {/* 1. Head */}
                    {wrongGuesses >= 1 && (
                        <circle 
                            cx="0" cy="30" r="26" 
                            fill={extendedMode ? bodyColor : "none"} 
                            stroke={strokeColor} 
                            strokeWidth="4" 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 2. Body */}
                    {wrongGuesses >= 2 && (
                        <ellipse 
                            cx="0" cy="95" rx="35" ry="32" 
                            fill={extendedMode ? bodyColor : "none"} 
                            stroke={strokeColor} 
                            strokeWidth="4" 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 3. Front Left Leg */}
                    {wrongGuesses >= 3 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M-18 115 Q-26 130 -28 152"
                                : "M-18 115 Q-20 130 -18 152"
                            }
                            fill="none" 
                            stroke={extendedMode ? bodyColor : strokeColor} 
                            strokeWidth={extendedMode ? "16" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 4. Front Right Leg */}
                    {wrongGuesses >= 4 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M18 115 Q26 130 28 152"
                                : "M18 115 Q20 130 18 152"
                            }
                            fill="none" 
                            stroke={extendedMode ? bodyColor : strokeColor} 
                            strokeWidth={extendedMode ? "16" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 5. Back Left Leg */}
                    {wrongGuesses >= 5 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M-28 105 Q-38 125 -42 148"
                                : "M-28 105 Q-32 125 -30 148"
                            }
                            fill="none" 
                            stroke={extendedMode ? bodyColor : strokeColor} 
                            strokeWidth={extendedMode ? "16" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 6. Back Right Leg */}
                    {wrongGuesses >= 6 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M28 105 Q38 125 42 148"
                                : "M28 105 Q32 125 30 148"
                            }
                            fill="none" 
                            stroke={extendedMode ? bodyColor : strokeColor} 
                            strokeWidth={extendedMode ? "16" : "4"} 
                            strokeLinecap="round"
                        />
                    )}

                    {/* Extended mode details (7-20) */}
                    {extendedMode && (
                        <>
                            {/* 7. Left Eye */}
                            {wrongGuesses >= 7 && (
                                <g>
                                    <ellipse cx="-10" cy="24" rx="4" ry="5" fill="white" />
                                    {!isDefeated ? (
                                        <>
                                            <circle cx="-9" cy="25" r="2.5" fill={eyeColor} />
                                            <circle cx="-7" cy="23" r="1" fill="white" />
                                        </>
                                    ) : (
                                        <g stroke="#555" strokeWidth="2" strokeLinecap="round">
                                            <line x1="-13" y1="21" x2="-7" y2="29" />
                                            <line x1="-7" y1="21" x2="-13" y2="29" />
                                        </g>
                                    )}
                                </g>
                            )}
                            
                            {/* 8. Right Eye */}
                            {wrongGuesses >= 8 && (
                                <g>
                                    <ellipse cx="10" cy="24" rx="4" ry="5" fill="white" />
                                    {!isDefeated ? (
                                        <>
                                            <circle cx="11" cy="25" r="2.5" fill={eyeColor} />
                                            <circle cx="13" cy="23" r="1" fill="white" />
                                        </>
                                    ) : (
                                        <g stroke="#555" strokeWidth="2" strokeLinecap="round">
                                            <line x1="7" y1="21" x2="13" y2="29" />
                                            <line x1="13" y1="21" x2="7" y2="29" />
                                        </g>
                                    )}
                                </g>
                            )}
                            
                            {/* 9. Trunk (outlined) */}
                            {wrongGuesses >= 9 && (
                                <path
                                    d={isDefeated 
                                        ? "M0 50 Q-4 70 -6 90 Q-8 105 -3 115 Q2 118 6 112"
                                        : "M0 50 Q5 75 12 95 Q18 110 28 115 Q32 115 34 110"
                                    }
                                    fill="none"
                                    stroke={bodyColor}
                                    strokeWidth="12"
                                    strokeLinecap="round"
                                />
                            )}
                            
                            {/* 9b. Trunk outline for visibility */}
                            {wrongGuesses >= 9 && (
                                <path
                                    d={isDefeated 
                                        ? "M0 50 Q-4 70 -6 90 Q-8 105 -3 115 Q2 118 6 112"
                                        : "M0 50 Q5 75 12 95 Q18 110 28 115 Q32 115 34 110"
                                    }
                                    fill="none"
                                    stroke={bodyDark}
                                    strokeWidth="14"
                                    strokeLinecap="round"
                                    opacity="0.3"
                                />
                            )}
                            
                            {/* 10. Trunk tip */}
                            {wrongGuesses >= 10 && (
                                <ellipse 
                                    cx={isDefeated ? "2" : "34"} 
                                    cy={isDefeated ? "116" : "112"} 
                                    rx="5" ry="6" 
                                    fill={earInner}
                                    opacity="0.7"
                                />
                            )}
                            
                            {/* 11. Left Ear */}
                            {wrongGuesses >= 11 && (
                                <ellipse cx="-30" cy="35" rx="16" ry="22" fill={bodyColor} stroke={bodyDark} strokeWidth="2" />
                            )}
                            
                            {/* 12. Right Ear */}
                            {wrongGuesses >= 12 && (
                                <ellipse cx="30" cy="35" rx="16" ry="22" fill={bodyColor} stroke={bodyDark} strokeWidth="2" />
                            )}
                            
                            {/* 13. Left Ear Inner */}
                            {wrongGuesses >= 13 && (
                                <ellipse cx="-30" cy="38" rx="10" ry="15" fill={earInner} opacity="0.5" />
                            )}
                            
                            {/* 14. Right Ear Inner */}
                            {wrongGuesses >= 14 && (
                                <ellipse cx="30" cy="38" rx="10" ry="15" fill={earInner} opacity="0.5" />
                            )}
                            
                            {/* 15. Left Tusk */}
                            {wrongGuesses >= 15 && (
                                <path
                                    d="M-8 48 Q-14 58 -16 70 Q-18 76 -14 78"
                                    fill="none"
                                    stroke="#FFFAF0"
                                    strokeWidth="4"
                                    strokeLinecap="round"
                                />
                            )}
                            
                            {/* 16. Right Tusk */}
                            {wrongGuesses >= 16 && (
                                <path
                                    d="M8 48 Q14 58 16 70 Q18 76 14 78"
                                    fill="none"
                                    stroke="#FFFAF0"
                                    strokeWidth="4"
                                    strokeLinecap="round"
                                />
                            )}
                            
                            {/* 17. Tail */}
                            {wrongGuesses >= 17 && (
                                <g>
                                    <path
                                        d={isDefeated 
                                            ? "M32 85 Q42 92 44 105"
                                            : "M32 85 Q48 82 52 92 Q55 100 52 108"
                                        }
                                        fill="none"
                                        stroke={bodyColor}
                                        strokeWidth="5"
                                        strokeLinecap="round"
                                    />
                                    <ellipse 
                                        cx={isDefeated ? "44" : "52"} 
                                        cy={isDefeated ? "108" : "112"} 
                                        rx="4" ry="7" 
                                        fill={bodyDark} 
                                    />
                                </g>
                            )}
                            
                            {/* 18. Front Left Foot */}
                            {wrongGuesses >= 18 && (
                                <g>
                                    <ellipse cx={isDefeated ? "-28" : "-18"} cy="156" rx="10" ry="6" fill={bodyDark} />
                                    <g fill="#E8E8E8">
                                        <ellipse cx={isDefeated ? "-33" : "-23"} cy="156" rx="2" ry="2.5" />
                                        <ellipse cx={isDefeated ? "-28" : "-18"} cy="158" rx="2" ry="2.5" />
                                        <ellipse cx={isDefeated ? "-23" : "-13"} cy="156" rx="2" ry="2.5" />
                                    </g>
                                </g>
                            )}
                            
                            {/* 19. Front Right Foot */}
                            {wrongGuesses >= 19 && (
                                <g>
                                    <ellipse cx={isDefeated ? "28" : "18"} cy="156" rx="10" ry="6" fill={bodyDark} />
                                    <g fill="#E8E8E8">
                                        <ellipse cx={isDefeated ? "23" : "13"} cy="156" rx="2" ry="2.5" />
                                        <ellipse cx={isDefeated ? "28" : "18"} cy="158" rx="2" ry="2.5" />
                                        <ellipse cx={isDefeated ? "33" : "23"} cy="156" rx="2" ry="2.5" />
                                    </g>
                                </g>
                            )}
                            
                            {/* 20. Body highlight */}
                            {wrongGuesses >= 20 && (
                                <ellipse cx="-10" cy="90" rx="18" ry="16" fill={bodyLight} opacity="0.4" />
                            )}
                        </>
                    )}
                </g>
            );
        };

        // ============================================
        // PIG FIGURE (20 parts)
        // ============================================
        const PigFigure = ({ wrongGuesses, colors, extendedMode }) => {
            const strokeColor = colors.figure || "#00E5FF";
            const bodyColor = colors.clothing || "#FFB6C1";
            const bodyDark = "#E8A0AA";
            const bodyLight = "#FFD4DC";
            const snoutColor = "#FF9CAD";
            const eyeColor = colors.eyes || "#4A3728";
            const isDefeated = wrongGuesses >= 6;

            return (
                <g transform="translate(100, 45)">
                    {/* 1. Head */}
                    {wrongGuesses >= 1 && (
                        <circle 
                            cx="0" cy="30" r="22" 
                            fill={extendedMode ? bodyColor : "none"} 
                            stroke={strokeColor} 
                            strokeWidth="4" 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 2. Body - connected to head */}
                    {wrongGuesses >= 2 && (
                        <ellipse 
                            cx="0" cy="78" rx="32" ry="28" 
                            fill={extendedMode ? bodyColor : "none"} 
                            stroke={strokeColor} 
                            strokeWidth="4" 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* Neck connector - shows when both head and body are visible */}
                    {wrongGuesses >= 2 && extendedMode && (
                        <ellipse 
                            cx="0" cy="52" rx="14" ry="8" 
                            fill={bodyColor}
                        />
                    )}
                    
                    {/* 2. Body */}
                    {wrongGuesses >= 2 && (
                        <ellipse 
                            cx="0" cy="85" rx="32" ry="28" 
                            fill={extendedMode ? bodyColor : "none"} 
                            stroke={strokeColor} 
                            strokeWidth="4" 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 3. Front Left Leg */}
                    {wrongGuesses >= 3 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M-16 98 Q-24 113 -26 133"
                                : "M-16 98 Q-18 113 -16 133"
                            }
                            fill="none" 
                            stroke={extendedMode ? bodyColor : strokeColor} 
                            strokeWidth={extendedMode ? "12" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 4. Front Right Leg */}
                    {wrongGuesses >= 4 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M16 98 Q24 113 26 133"
                                : "M16 98 Q18 113 16 133"
                            }
                            fill="none" 
                            stroke={extendedMode ? bodyColor : strokeColor} 
                            strokeWidth={extendedMode ? "12" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 5. Back Left Leg */}
                    {wrongGuesses >= 5 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M-25 88 Q-35 105 -38 128"
                                : "M-25 88 Q-30 105 -28 128"
                            }
                            fill="none" 
                            stroke={extendedMode ? bodyColor : strokeColor} 
                            strokeWidth={extendedMode ? "12" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 6. Back Right Leg */}
                    {wrongGuesses >= 6 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M25 88 Q35 105 38 128"
                                : "M25 88 Q30 105 28 128"
                            }
                            fill="none" 
                            stroke={extendedMode ? bodyColor : strokeColor} 
                            strokeWidth={extendedMode ? "12" : "4"} 
                            strokeLinecap="round"
                        />
                    )}

                    {/* Extended mode details (7-20) */}
                    {extendedMode && (
                        <>
                            {/* 7. Left Eye */}
                            {wrongGuesses >= 7 && (
                                <g>
                                    <ellipse cx="-8" cy="25" rx="4" ry="5" fill="white" />
                                    {!isDefeated ? (
                                        <>
                                            <circle cx="-7" cy="26" r="2.5" fill={eyeColor} />
                                            <circle cx="-5" cy="24" r="1" fill="white" />
                                        </>
                                    ) : (
                                        <g stroke="#555" strokeWidth="2" strokeLinecap="round">
                                            <line x1="-11" y1="22" x2="-5" y2="30" />
                                            <line x1="-5" y1="22" x2="-11" y2="30" />
                                        </g>
                                    )}
                                </g>
                            )}
                            
                            {/* 8. Right Eye */}
                            {wrongGuesses >= 8 && (
                                <g>
                                    <ellipse cx="8" cy="25" rx="4" ry="5" fill="white" />
                                    {!isDefeated ? (
                                        <>
                                            <circle cx="9" cy="26" r="2.5" fill={eyeColor} />
                                            <circle cx="11" cy="24" r="1" fill="white" />
                                        </>
                                    ) : (
                                        <g stroke="#555" strokeWidth="2" strokeLinecap="round">
                                            <line x1="5" y1="22" x2="11" y2="30" />
                                            <line x1="11" y1="22" x2="5" y2="30" />
                                        </g>
                                    )}
                                </g>
                            )}
                            
                            {/* 9. Snout */}
                            {wrongGuesses >= 9 && (
                                <g>
                                    <ellipse cx="0" cy="39" rx="12" ry="9" fill={snoutColor} />
                                    <ellipse cx="0" cy="39" rx="10" ry="7" fill={bodyLight} opacity="0.3" />
                                </g>
                            )}
                            
                            {/* 10. Nostrils */}
                            {wrongGuesses >= 10 && (
                                <g>
                                    <ellipse cx="-4" cy="39" rx="2.5" ry="3.5" fill={bodyDark} />
                                    <ellipse cx="4" cy="39" rx="2.5" ry="3.5" fill={bodyDark} />
                                </g>
                            )}
                            
                            {/* 11. Left Ear */}
                            {wrongGuesses >= 11 && (
                                <path
                                    d="M-16 13 Q-22 3 -18 -5 Q-12 -8 -8 2 Q-10 9 -13 15"
                                    fill={bodyColor}
                                    stroke={bodyDark}
                                    strokeWidth="2"
                                />
                            )}
                            
                            {/* 12. Right Ear */}
                            {wrongGuesses >= 12 && (
                                <path
                                    d="M16 13 Q22 3 18 -5 Q12 -8 8 2 Q10 9 13 15"
                                    fill={bodyColor}
                                    stroke={bodyDark}
                                    strokeWidth="2"
                                />
                            )}
                            
                            {/* 13. Curly Tail */}
                            {wrongGuesses >= 13 && (
                                <path
                                    d={isDefeated 
                                        ? "M30 73 Q38 75 40 83"
                                        : "M30 73 Q42 68 45 75 Q48 83 44 88 Q40 93 44 98 Q48 103 44 108"
                                    }
                                    fill="none"
                                    stroke={bodyColor}
                                    strokeWidth="5"
                                    strokeLinecap="round"
                                />
                            )}
                            
                            {/* 14. Mouth */}
                            {wrongGuesses >= 14 && (
                                <path 
                                    d={isDefeated ? "M-6 49 Q0 45 6 49" : "M-6 49 Q0 53 6 49"} 
                                    fill="none" 
                                    stroke={bodyDark} 
                                    strokeWidth="2" 
                                    strokeLinecap="round"
                                />
                            )}
                            
                            {/* 15. Front Left Hoof */}
                            {wrongGuesses >= 15 && (
                                <g>
                                    <ellipse cx={isDefeated ? "-26" : "-16"} cy="137" rx="7" ry="5" fill="#4A3728" />
                                    <path d={`M${isDefeated ? "-26" : "-16"} 133 L${isDefeated ? "-26" : "-16"} 137`} stroke="#3A2718" strokeWidth="2" />
                                </g>
                            )}
                            
                            {/* 16. Front Right Hoof */}
                            {wrongGuesses >= 16 && (
                                <g>
                                    <ellipse cx={isDefeated ? "26" : "16"} cy="137" rx="7" ry="5" fill="#4A3728" />
                                    <path d={`M${isDefeated ? "26" : "16"} 133 L${isDefeated ? "26" : "16"} 137`} stroke="#3A2718" strokeWidth="2" />
                                </g>
                            )}
                            
                            {/* 17. Back Left Hoof */}
                            {wrongGuesses >= 17 && (
                                <g>
                                    <ellipse cx={isDefeated ? "-38" : "-28"} cy="132" rx="7" ry="5" fill="#4A3728" />
                                    <path d={`M${isDefeated ? "-38" : "-28"} 128 L${isDefeated ? "-38" : "-28"} 132`} stroke="#3A2718" strokeWidth="2" />
                                </g>
                            )}
                            
                            {/* 18. Back Right Hoof */}
                            {wrongGuesses >= 18 && (
                                <g>
                                    <ellipse cx={isDefeated ? "38" : "28"} cy="132" rx="7" ry="5" fill="#4A3728" />
                                    <path d={`M${isDefeated ? "38" : "28"} 128 L${isDefeated ? "38" : "28"} 132`} stroke="#3A2718" strokeWidth="2" />
                                </g>
                            )}
                            
                            {/* 19. Belly patch */}
                            {wrongGuesses >= 19 && (
                                <ellipse cx="0" cy="81" rx="20" ry="16" fill={bodyLight} opacity="0.5" />
                            )}
                            
                            {/* 20. Mud spots */}
                            {wrongGuesses >= 20 && (
                                <g fill="#8B6914" opacity="0.4">
                                    <ellipse cx="-10" cy="68" rx="5" ry="3" />
                                    <ellipse cx="12" cy="83" rx="4" ry="5" />
                                    <circle cx="6" cy="63" r="3" />
                                </g>
                            )}
                        </>
                    )}
                </g>
            );
        };

        // ============================================
        // HORSE FIGURE (20 parts)
        // ============================================
        const HorseFigure = ({ wrongGuesses, colors, extendedMode }) => {
            const strokeColor = colors.figure || "#00E5FF";
            const bodyColor = colors.clothing || "#8B4513";
            const bodyDark = "#6B3410";
            const bodyLight = "#A0522D";
            const maneColor = colors.facialHair || "#2C2C2C";
            const eyeColor = colors.eyes || "#4A3728";
            const isDefeated = wrongGuesses >= 6;

            return (
                <g transform="translate(100, 30)">
                    {/* 1. Head */}
                    {wrongGuesses >= 1 && (
                        <ellipse 
                            cx="0" cy="25" rx="14" ry="22" 
                            fill={extendedMode ? bodyColor : "none"} 
                            stroke={strokeColor} 
                            strokeWidth="4" 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 2. Body */}
                    {wrongGuesses >= 2 && (
                        <ellipse 
                            cx="0" cy="95" rx="30" ry="28" 
                            fill={extendedMode ? bodyColor : "none"} 
                            stroke={strokeColor} 
                            strokeWidth="4" 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* Neck connector - shows when both head and body are visible */}
                    {wrongGuesses >= 2 && (
                        <path 
                            d={extendedMode 
                                ? "M-10 45 Q-12 55 -10 67 L10 67 Q12 55 10 45"
                                : "M0 47 Q0 55 0 67"
                            }
                            fill={extendedMode ? bodyColor : "none"} 
                            stroke={extendedMode ? bodyColor : strokeColor} 
                            strokeWidth={extendedMode ? "2" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 3. Front Left Leg */}
                    {wrongGuesses >= 3 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M-14 115 Q-22 135 -24 160"
                                : "M-14 115 Q-16 135 -14 160"
                            }
                            fill="none" 
                            stroke={extendedMode ? bodyColor : strokeColor} 
                            strokeWidth={extendedMode ? "10" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 4. Front Right Leg */}
                    {wrongGuesses >= 4 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M14 115 Q22 135 24 160"
                                : "M14 115 Q16 135 14 160"
                            }
                            fill="none" 
                            stroke={extendedMode ? bodyColor : strokeColor} 
                            strokeWidth={extendedMode ? "10" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 5. Back Left Leg */}
                    {wrongGuesses >= 5 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M-24 108 Q-34 130 -36 155"
                                : "M-24 108 Q-28 130 -26 155"
                            }
                            fill="none" 
                            stroke={extendedMode ? bodyColor : strokeColor} 
                            strokeWidth={extendedMode ? "10" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 6. Back Right Leg */}
                    {wrongGuesses >= 6 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M24 108 Q34 130 36 155"
                                : "M24 108 Q28 130 26 155"
                            }
                            fill="none" 
                            stroke={extendedMode ? bodyColor : strokeColor} 
                            strokeWidth={extendedMode ? "10" : "4"} 
                            strokeLinecap="round"
                        />
                    )}

                    {/* Extended mode details (7-20) */}
                    {extendedMode && (
                        <>
                            {/* 7. Left Eye */}
                            {wrongGuesses >= 7 && (
                                <g>
                                    <ellipse cx="-5" cy="19" rx="3" ry="4" fill="white" />
                                    {!isDefeated ? (
                                        <>
                                            <circle cx="-4" cy="20" r="2" fill={eyeColor} />
                                            <circle cx="-3" cy="18" r="0.8" fill="white" />
                                        </>
                                    ) : (
                                        <g stroke="#333" strokeWidth="2" strokeLinecap="round">
                                            <line x1="-7" y1="17" x2="-3" y2="23" />
                                            <line x1="-3" y1="17" x2="-7" y2="23" />
                                        </g>
                                    )}
                                </g>
                            )}
                            
                            {/* 8. Right Eye */}
                            {wrongGuesses >= 8 && (
                                <g>
                                    <ellipse cx="5" cy="19" rx="3" ry="4" fill="white" />
                                    {!isDefeated ? (
                                        <>
                                            <circle cx="6" cy="20" r="2" fill={eyeColor} />
                                            <circle cx="7" cy="18" r="0.8" fill="white" />
                                        </>
                                    ) : (
                                        <g stroke="#333" strokeWidth="2" strokeLinecap="round">
                                            <line x1="3" y1="17" x2="7" y2="23" />
                                            <line x1="7" y1="17" x2="3" y2="23" />
                                        </g>
                                    )}
                                </g>
                            )}
                            
                            {/* 9. Muzzle */}
                            {wrongGuesses >= 9 && (
                                <ellipse cx="0" cy="39" rx="8" ry="6" fill={bodyLight} />
                            )}
                            
                            {/* 10. Nostrils */}
                            {wrongGuesses >= 10 && (
                                <g>
                                    <ellipse cx="-3" cy="41" rx="2" ry="2.5" fill={bodyDark} />
                                    <ellipse cx="3" cy="41" rx="2" ry="2.5" fill={bodyDark} />
                                </g>
                            )}
                            
                            {/* 11. Left Ear */}
                            {wrongGuesses >= 11 && (
                                <path
                                    d="M-8 5 L-6 -9 L-2 3 Z"
                                    fill={bodyColor}
                                    stroke={bodyDark}
                                    strokeWidth="1"
                                />
                            )}
                            
                            {/* 12. Right Ear */}
                            {wrongGuesses >= 12 && (
                                <path
                                    d="M8 5 L6 -9 L2 3 Z"
                                    fill={bodyColor}
                                    stroke={bodyDark}
                                    strokeWidth="1"
                                />
                            )}
                            
                            {/* 13. Mane (head) */}
                            {wrongGuesses >= 13 && (
                                <path
                                    d="M-4 -2 Q0 -7 4 -2 Q6 1 8 5 Q6 9 4 7 Q0 3 -4 7 Q-6 9 -8 5 Q-6 1 -4 -2"
                                    fill={maneColor}
                                />
                            )}
                            
                            {/* 14. Neck/Mane */}
                            {wrongGuesses >= 14 && (
                                <path
                                    d="M-10 45 Q-16 55 -14 68 Q-12 78 -14 88"
                                    fill="none"
                                    stroke={maneColor}
                                    strokeWidth="8"
                                    strokeLinecap="round"
                                />
                            )}
                            
                            {/* 15. Tail */}
                            {wrongGuesses >= 15 && (
                                <path
                                    d={isDefeated 
                                        ? "M28 90 Q42 100 40 120 Q38 135 32 145"
                                        : "M28 90 Q50 85 55 100 Q58 115 52 130 Q48 140 55 150"
                                    }
                                    fill="none"
                                    stroke={maneColor}
                                    strokeWidth="10"
                                    strokeLinecap="round"
                                />
                            )}
                            
                            {/* 16. Front Left Hoof */}
                            {wrongGuesses >= 16 && (
                                <ellipse 
                                    cx={isDefeated ? "-24" : "-14"} 
                                    cy="164" 
                                    rx="6" ry="4" 
                                    fill="#2C2C2C" 
                                />
                            )}
                            
                            {/* 17. Front Right Hoof */}
                            {wrongGuesses >= 17 && (
                                <ellipse 
                                    cx={isDefeated ? "24" : "14"} 
                                    cy="164" 
                                    rx="6" ry="4" 
                                    fill="#2C2C2C" 
                                />
                            )}
                            
                            {/* 18. Back Left Hoof */}
                            {wrongGuesses >= 18 && (
                                <ellipse 
                                    cx={isDefeated ? "-36" : "-26"} 
                                    cy="159" 
                                    rx="6" ry="4" 
                                    fill="#2C2C2C" 
                                />
                            )}
                            
                            {/* 19. Back Right Hoof */}
                            {wrongGuesses >= 19 && (
                                <ellipse 
                                    cx={isDefeated ? "36" : "26"} 
                                    cy="159" 
                                    rx="6" ry="4" 
                                    fill="#2C2C2C" 
                                />
                            )}
                            
                            {/* 20. White blaze/markings */}
                            {wrongGuesses >= 20 && (
                                <g fill="white" opacity="0.8">
                                    <path d="M-2 11 Q0 7 2 11 Q3 23 2 35 Q0 38 -2 35 Q-3 23 -2 11" />
                                    <ellipse cx={isDefeated ? "-24" : "-14"} cy="156" rx="4" ry="6" />
                                </g>
                            )}
                        </>
                    )}
                </g>
            );
        };

        // ============================================
        // CHICKEN FIGURE (20 parts)
        // ============================================
        const ChickenFigure = ({ wrongGuesses, colors, extendedMode }) => {
            const strokeColor = colors.figure || "#00E5FF";
            const bodyColor = colors.clothing || "#F5DEB3";
            const bodyDark = "#DEB887";
            const bodyLight = "#FFF8DC";
            const combColor = "#E74C3C";
            const beakColor = "#F4A460";
            const wattleColor = "#C0392B";
            const eyeColor = colors.eyes || "#2C2C2C";
            const isDefeated = wrongGuesses >= 6;

            return (
                <g transform="translate(100, 40)">
                    {/* 1. Head */}
                    {wrongGuesses >= 1 && (
                        <circle 
                            cx="0" cy="25" r="18" 
                            fill={extendedMode ? bodyColor : "none"} 
                            stroke={strokeColor} 
                            strokeWidth="4" 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 2. Body */}
                    {wrongGuesses >= 2 && (
                        <ellipse 
                            cx="0" cy="85" rx="26" ry="32" 
                            fill={extendedMode ? bodyColor : "none"} 
                            stroke={strokeColor} 
                            strokeWidth="4" 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 3. Left Leg */}
                    {wrongGuesses >= 3 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M-10 115 Q-18 130 -20 145"
                                : "M-10 115 Q-12 130 -10 145"
                            }
                            fill="none" 
                            stroke={extendedMode ? beakColor : strokeColor} 
                            strokeWidth={extendedMode ? "6" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 4. Right Leg */}
                    {wrongGuesses >= 4 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M10 115 Q18 130 20 145"
                                : "M10 115 Q12 130 10 145"
                            }
                            fill="none" 
                            stroke={extendedMode ? beakColor : strokeColor} 
                            strokeWidth={extendedMode ? "6" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 5. Left Wing */}
                    {wrongGuesses >= 5 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M-22 75 Q-32 85 -28 100 Q-24 108 -18 102"
                                : "M-22 75 Q-35 80 -32 95 Q-28 105 -20 100"
                            }
                            fill={extendedMode ? bodyDark : "none"} 
                            stroke={extendedMode ? bodyDark : strokeColor} 
                            strokeWidth={extendedMode ? "2" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 6. Right Wing */}
                    {wrongGuesses >= 6 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M22 75 Q32 85 28 100 Q24 108 18 102"
                                : "M22 75 Q35 80 32 95 Q28 105 20 100"
                            }
                            fill={extendedMode ? bodyDark : "none"} 
                            stroke={extendedMode ? bodyDark : strokeColor} 
                            strokeWidth={extendedMode ? "2" : "4"} 
                            strokeLinecap="round"
                        />
                    )}

                    {/* Extended mode details (7-20) */}
                    {extendedMode && (
                        <>
                            {/* 7. Left Eye */}
                            {wrongGuesses >= 7 && (
                                <g>
                                    <circle cx="-6" cy="22" r="4" fill="white" />
                                    {!isDefeated ? (
                                        <>
                                            <circle cx="-5" cy="23" r="2.5" fill={eyeColor} />
                                            <circle cx="-4" cy="21" r="1" fill="white" />
                                        </>
                                    ) : (
                                        <g fill="none" stroke="#333" strokeWidth="2">
                                            <path d="M-8 22 Q-6 20 -4 22 Q-6 24 -8 22" />
                                        </g>
                                    )}
                                </g>
                            )}
                            
                            {/* 8. Right Eye */}
                            {wrongGuesses >= 8 && (
                                <g>
                                    <circle cx="6" cy="22" r="4" fill="white" />
                                    {!isDefeated ? (
                                        <>
                                            <circle cx="7" cy="23" r="2.5" fill={eyeColor} />
                                            <circle cx="8" cy="21" r="1" fill="white" />
                                        </>
                                    ) : (
                                        <g fill="none" stroke="#333" strokeWidth="2">
                                            <path d="M4 22 Q6 20 8 22 Q6 24 4 22" />
                                        </g>
                                    )}
                                </g>
                            )}
                            
                            {/* 9. Beak */}
                            {wrongGuesses >= 9 && (
                                <g>
                                    <path d="M-6 30 L0 40 L6 30 Q3 32 0 32 Q-3 32 -6 30" fill={beakColor} />
                                    <path d="M-5 30 L0 37 L5 30" fill="#E8945A" />
                                </g>
                            )}
                            
                            {/* 10. Comb */}
                            {wrongGuesses >= 10 && (
                                <path
                                    d="M-6 10 Q-4 -2 0 8 Q2 -4 4 8 Q6 -2 6 10 Q3 14 0 12 Q-3 14 -6 10"
                                    fill={combColor}
                                />
                            )}
                            
                            {/* 11. Wattle */}
                            {wrongGuesses >= 11 && (
                                <path
                                    d="M-2 40 Q-4 48 -1 54 Q1 56 3 54 Q6 48 4 40"
                                    fill={wattleColor}
                                />
                            )}
                            
                            {/* 12. Left Foot */}
                            {wrongGuesses >= 12 && (
                                <g stroke={beakColor} strokeWidth="3" strokeLinecap="round" fill="none">
                                    <path d={`M${isDefeated ? "-20" : "-10"} 145 L${isDefeated ? "-28" : "-18"} 152`} />
                                    <path d={`M${isDefeated ? "-20" : "-10"} 145 L${isDefeated ? "-20" : "-10"} 155`} />
                                    <path d={`M${isDefeated ? "-20" : "-10"} 145 L${isDefeated ? "-12" : "-2"} 152`} />
                                </g>
                            )}
                            
                            {/* 13. Right Foot */}
                            {wrongGuesses >= 13 && (
                                <g stroke={beakColor} strokeWidth="3" strokeLinecap="round" fill="none">
                                    <path d={`M${isDefeated ? "20" : "10"} 145 L${isDefeated ? "12" : "2"} 152`} />
                                    <path d={`M${isDefeated ? "20" : "10"} 145 L${isDefeated ? "20" : "10"} 155`} />
                                    <path d={`M${isDefeated ? "20" : "10"} 145 L${isDefeated ? "28" : "18"} 152`} />
                                </g>
                            )}
                            
                            {/* 14. Tail Feathers */}
                            {wrongGuesses >= 14 && (
                                <g fill={bodyDark}>
                                    <path
                                        d={isDefeated 
                                            ? "M22 70 Q35 68 38 78 Q36 84 30 80"
                                            : "M22 70 Q40 60 45 50 Q43 55 40 60"
                                        }
                                    />
                                    <path
                                        d={isDefeated 
                                            ? "M24 78 Q37 78 40 88 Q38 94 32 90"
                                            : "M24 75 Q42 68 46 60 Q44 66 40 72"
                                        }
                                    />
                                    <path
                                        d={isDefeated 
                                            ? "M22 86 Q32 88 35 98 Q33 103 27 98"
                                            : "M22 80 Q38 76 42 70 Q40 76 36 82"
                                        }
                                    />
                                </g>
                            )}
                            
                            {/* 15. Left Wing feathers */}
                            {wrongGuesses >= 15 && (
                                <g stroke={bodyDark} strokeWidth="2" fill="none">
                                    <path d="M-20 82 Q-24 88 -20 94" />
                                    <path d="M-16 85 Q-20 91 -16 97" />
                                </g>
                            )}
                            
                            {/* 16. Right Wing feathers */}
                            {wrongGuesses >= 16 && (
                                <g stroke={bodyDark} strokeWidth="2" fill="none">
                                    <path d="M20 82 Q24 88 20 94" />
                                    <path d="M16 85 Q20 91 16 97" />
                                </g>
                            )}
                            
                            {/* 17. Chest feathers */}
                            {wrongGuesses >= 17 && (
                                <ellipse cx="0" cy="65" rx="12" ry="10" fill={bodyLight} opacity="0.7" />
                            )}
                            
                            {/* 18. Body feather texture */}
                            {wrongGuesses >= 18 && (
                                <g stroke={bodyDark} strokeWidth="1.5" fill="none" opacity="0.5">
                                    <path d="M-8 75 Q0 78 8 75" />
                                    <path d="M-10 85 Q0 88 10 85" />
                                    <path d="M-8 95 Q0 98 8 95" />
                                </g>
                            )}
                            
                            {/* 19. Eyebrow tufts */}
                            {wrongGuesses >= 19 && (
                                <g stroke={bodyDark} strokeWidth="2" strokeLinecap="round">
                                    <path d="M-10 17 Q-8 15 -6 16" fill="none" />
                                    <path d="M6 16 Q8 15 10 17" fill="none" />
                                </g>
                            )}
                            
                            {/* 20. Cheek blush */}
                            {wrongGuesses >= 20 && (
                                <g>
                                    <ellipse cx="-12" cy="28" rx="3" ry="2" fill="#FFB6C1" opacity="0.5" />
                                    <ellipse cx="12" cy="28" rx="3" ry="2" fill="#FFB6C1" opacity="0.5" />
                                </g>
                            )}
                        </>
                    )}
                </g>
            );
        };

        // ============================================
        // ALIEN FIGURE (20 parts)
        // ============================================
        const AlienFigure = ({ wrongGuesses, colors, extendedMode }) => {
            const strokeColor = colors.figure || "#00E5FF";
            const bodyColor = colors.clothing || "#7ED321";
            const bodyDark = "#5FB318";
            const bodyLight = "#A8E063";
            const suitColor = "#8B5CF6";
            const suitAccent = "#7C3AED";
            const isDefeated = wrongGuesses >= 6;

            return (
                <g transform="translate(100, 35)">
                    {/* 1. Head */}
                    {wrongGuesses >= 1 && (
                        <ellipse 
                            cx="0" cy="28" rx="26" ry="30" 
                            fill={extendedMode ? bodyColor : "none"} 
                            stroke={strokeColor} 
                            strokeWidth="4" 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 2. Body/Suit */}
                    {wrongGuesses >= 2 && (
                        <ellipse 
                            cx="0" cy="100" rx="24" ry="30" 
                            fill={extendedMode ? suitColor : "none"} 
                            stroke={extendedMode ? suitAccent : strokeColor} 
                            strokeWidth="4" 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 3. Left Arm */}
                    {wrongGuesses >= 3 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M-22 85 Q-32 100 -35 120"
                                : "M-22 85 Q-35 95 -42 110"
                            }
                            fill="none" 
                            stroke={extendedMode ? suitColor : strokeColor} 
                            strokeWidth={extendedMode ? "10" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 4. Right Arm */}
                    {wrongGuesses >= 4 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M22 85 Q32 100 35 120"
                                : "M22 85 Q35 95 42 110"
                            }
                            fill="none" 
                            stroke={extendedMode ? suitColor : strokeColor} 
                            strokeWidth={extendedMode ? "10" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 5. Left Leg */}
                    {wrongGuesses >= 5 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M-10 128 Q-18 145 -20 165"
                                : "M-10 128 Q-12 145 -10 165"
                            }
                            fill="none" 
                            stroke={extendedMode ? suitColor : strokeColor} 
                            strokeWidth={extendedMode ? "12" : "4"} 
                            strokeLinecap="round"
                        />
                    )}
                    
                    {/* 6. Right Leg */}
                    {wrongGuesses >= 6 && (
                        <path 
                            d={isDefeated && extendedMode
                                ? "M10 128 Q18 145 20 165"
                                : "M10 128 Q12 145 10 165"
                            }
                            fill="none" 
                            stroke={extendedMode ? suitColor : strokeColor} 
                            strokeWidth={extendedMode ? "12" : "4"} 
                            strokeLinecap="round"
                        />
                    )}

                    {/* Extended mode details (7-20) */}
                    {extendedMode && (
                        <>
                            {/* 7. Left Eye */}
                            {wrongGuesses >= 7 && (
                                <g>
                                    <ellipse cx="-10" cy="24" rx="8" ry="12" fill="#1a1a1a" />
                                    <ellipse cx="-12" cy="22" rx="3" ry="4" fill="#333" />
                                    {!isDefeated && <ellipse cx="-13" cy="20" rx="2" ry="2.5" fill="white" opacity="0.6" />}
                                    {isDefeated && (
                                        <g fill="none" stroke="#4a4a4a" strokeWidth="2">
                                            <path d="M-13 24 Q-10 21 -7 24 Q-10 27 -13 24" />
                                        </g>
                                    )}
                                </g>
                            )}
                            
                            {/* 8. Right Eye */}
                            {wrongGuesses >= 8 && (
                                <g>
                                    <ellipse cx="10" cy="24" rx="8" ry="12" fill="#1a1a1a" />
                                    <ellipse cx="8" cy="22" rx="3" ry="4" fill="#333" />
                                    {!isDefeated && <ellipse cx="7" cy="20" rx="2" ry="2.5" fill="white" opacity="0.6" />}
                                    {isDefeated && (
                                        <g fill="none" stroke="#4a4a4a" strokeWidth="2">
                                            <path d="M7 24 Q10 21 13 24 Q10 27 7 24" />
                                        </g>
                                    )}
                                </g>
                            )}
                            
                            {/* 9. Mouth */}
                            {wrongGuesses >= 9 && (
                                <ellipse 
                                    cx="0" cy="45" rx="4" ry="2" 
                                    fill={isDefeated ? "none" : bodyDark}
                                    stroke={bodyDark}
                                    strokeWidth="1"
                                />
                            )}
                            
                            {/* 10. Left Antenna */}
                            {wrongGuesses >= 10 && (
                                <g>
                                    <path
                                        d="M-10 2 Q-14 -12 -8 -18"
                                        fill="none"
                                        stroke={bodyColor}
                                        strokeWidth="4"
                                        strokeLinecap="round"
                                    />
                                    <circle cx="-8" cy="-20" r="4" fill={bodyLight} />
                                    <circle cx="-8" cy="-20" r="2" fill="#FFD700" opacity="0.8" />
                                </g>
                            )}
                            
                            {/* 11. Right Antenna */}
                            {wrongGuesses >= 11 && (
                                <g>
                                    <path
                                        d="M10 2 Q14 -12 8 -18"
                                        fill="none"
                                        stroke={bodyColor}
                                        strokeWidth="4"
                                        strokeLinecap="round"
                                    />
                                    <circle cx="8" cy="-20" r="4" fill={bodyLight} />
                                    <circle cx="8" cy="-20" r="2" fill="#FFD700" opacity="0.8" />
                                </g>
                            )}
                            
                            {/* 12. Left Hand (3 fingers spread evenly) */}
                            {wrongGuesses >= 12 && (
                                <g>
                                    <circle 
                                        cx={isDefeated ? "-35" : "-42"} 
                                        cy={isDefeated ? "123" : "113"} 
                                        r="7" 
                                        fill={bodyColor} 
                                    />
                                    {/* Three fingers spread evenly */}
                                    <ellipse 
                                        cx={isDefeated ? "-42" : "-49"} 
                                        cy={isDefeated ? "118" : "108"} 
                                        rx="3" ry="5" 
                                        fill={bodyColor}
                                        transform={`rotate(-30 ${isDefeated ? "-42" : "-49"} ${isDefeated ? "118" : "108"})`}
                                    />
                                    <ellipse 
                                        cx={isDefeated ? "-35" : "-42"} 
                                        cy={isDefeated ? "115" : "105"} 
                                        rx="3" ry="5" 
                                        fill={bodyColor}
                                    />
                                    <ellipse 
                                        cx={isDefeated ? "-28" : "-35"} 
                                        cy={isDefeated ? "118" : "108"} 
                                        rx="3" ry="5" 
                                        fill={bodyColor}
                                        transform={`rotate(30 ${isDefeated ? "-28" : "-35"} ${isDefeated ? "118" : "108"})`}
                                    />
                                </g>
                            )}
                            
                            {/* 13. Right Hand (3 fingers spread evenly) */}
                            {wrongGuesses >= 13 && (
                                <g>
                                    <circle 
                                        cx={isDefeated ? "35" : "42"} 
                                        cy={isDefeated ? "123" : "113"} 
                                        r="7" 
                                        fill={bodyColor} 
                                    />
                                    {/* Three fingers spread evenly */}
                                    <ellipse 
                                        cx={isDefeated ? "28" : "35"} 
                                        cy={isDefeated ? "118" : "108"} 
                                        rx="3" ry="5" 
                                        fill={bodyColor}
                                        transform={`rotate(-30 ${isDefeated ? "28" : "35"} ${isDefeated ? "118" : "108"})`}
                                    />
                                    <ellipse 
                                        cx={isDefeated ? "35" : "42"} 
                                        cy={isDefeated ? "115" : "105"} 
                                        rx="3" ry="5" 
                                        fill={bodyColor}
                                    />
                                    <ellipse 
                                        cx={isDefeated ? "42" : "49"} 
                                        cy={isDefeated ? "118" : "108"} 
                                        rx="3" ry="5" 
                                        fill={bodyColor}
                                        transform={`rotate(30 ${isDefeated ? "42" : "49"} ${isDefeated ? "118" : "108"})`}
                                    />
                                </g>
                            )}
                            
                            {/* 14. Left Boot */}
                            {wrongGuesses >= 14 && (
                                <ellipse 
                                    cx={isDefeated ? "-20" : "-10"} 
                                    cy="170" 
                                    rx="9" ry="5" 
                                    fill="#2C2C2C" 
                                />
                            )}
                            
                            {/* 15. Right Boot */}
                            {wrongGuesses >= 15 && (
                                <ellipse 
                                    cx={isDefeated ? "20" : "10"} 
                                    cy="170" 
                                    rx="9" ry="5" 
                                    fill="#2C2C2C" 
                                />
                            )}
                            
                            {/* 16. Suit chest plate */}
                            {wrongGuesses >= 16 && (
                                <ellipse cx="0" cy="95" rx="15" ry="18" fill={suitAccent} opacity="0.6" />
                            )}
                            
                            {/* 17. Control panel */}
                            {wrongGuesses >= 17 && (
                                <g>
                                    <rect x="-8" y="88" width="16" height="12" rx="2" fill="#2C2C2C" />
                                    <circle cx="-4" cy="94" r="1.5" fill="#E74C3C" />
                                    <circle cx="4" cy="94" r="1.5" fill="#2ECC71" />
                                    <rect x="-2" y="98" width="4" height="1.5" rx="0.5" fill="#3498DB" />
                                </g>
                            )}
                            
                            {/* 18. Head shine */}
                            {wrongGuesses >= 18 && (
                                <ellipse cx="-8" cy="18" rx="10" ry="12" fill={bodyLight} opacity="0.4" />
                            )}
                            
                            {/* 19. Neck */}
                            {wrongGuesses >= 19 && (
                                <ellipse cx="0" cy="62" rx="8" ry="6" fill={bodyColor} />
                            )}
                            
                            {/* 20. Stars (if defeated) or helmet visor reflection */}
                            {wrongGuesses >= 20 && (
                                isDefeated ? (
                                    <g fill="#FFD700" opacity="0.8">
                                        <path d="M-38 5 L-36 10 L-41 10 Z" />
                                        <path d="M38 15 L40 20 L35 20 Z" />
                                        <path d="M-32 55 L-30 60 L-35 60 Z" />
                                        <path d="M42 45 L44 50 L39 50 Z" />
                                    </g>
                                ) : (
                                    <path 
                                        d="M-18 15 Q-10 10 -2 18" 
                                        fill="none" 
                                        stroke="white" 
                                        strokeWidth="2" 
                                        strokeLinecap="round"
                                        opacity="0.3"
                                    />
                                )
                            )}
                        </>
                    )}
                </g>
            );
        };

        // ============================================
        // WORD DISPLAY COMPONENT
        // ============================================
        
        const WordDisplay = ({ word, guessedLetters, category }) => {
            const words = word.split(' ');
            
            return (
                <div className="mb-10 w-full">
                    {category && (
                        <div className="text-center mb-4">
                            <span className="text-sm text-gray-400 uppercase tracking-wider">
                                Category: <span className="text-nova-cyan font-semibold">{category}</span>
                            </span>
                        </div>
                    )}
                    <div className="flex flex-wrap justify-center gap-4 md:gap-6">
                        {words.map((wordPart, wordIndex) => (
                            <div 
                                key={wordIndex}
                                className="flex gap-2 md:gap-3"
                                role="region"
                                aria-label={`Word ${wordIndex + 1}`}
                            >
                                {wordPart.split('').map((char, charIndex) => {
                                    const isGuessed = guessedLetters.has(char);
                                    
                                    return (
                                        <motion.div 
                                            key={`${wordIndex}-${charIndex}`}
                                            initial={{ y: -20, opacity: 0 }}
                                            animate={{ y: 0, opacity: 1 }}
                                            transition={{ delay: (wordIndex * wordPart.length + charIndex) * 0.03 }}
                                            className={`
                                                w-8 h-12 md:w-10 md:h-14 flex items-center justify-center 
                                                border-b-4 text-xl md:text-3xl font-bold font-mono
                                                ${isGuessed 
                                                    ? 'border-gray-600 text-white' 
                                                    : 'border-white/30 text-transparent'
                                                }
                                            `}
                                            aria-label={isGuessed ? char : 'hidden letter'}
                                        >
                                            {isGuessed ? char : '_'}
                                        </motion.div>
                                    );
                                })}
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        // ============================================
        // KEYBOARD COMPONENT
        // ============================================
        
        const Keyboard = ({ onGuess, guessedLetters, word, disabled }) => {
            const alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");
            
            return (
                <div 
                    className="grid grid-cols-9 gap-1.5 md:gap-2 max-w-3xl mx-auto px-2"
                    role="region"
                    aria-label="Letter keyboard"
                >
                    {alphabet.map((letter) => {
                        const isGuessed = guessedLetters.has(letter);
                        const isCorrect = word.includes(letter);
                        
                        let btnClass = "key-btn rounded flex items-center justify-center h-10 md:h-12 font-bold font-mono text-sm md:text-base border transition-all duration-200 ";
                        
                        if (isGuessed) {
                            if (isCorrect) {
                                btnClass += "bg-green-900/30 border-green-500 text-green-400 cursor-default opacity-70";
                            } else {
                                btnClass += "bg-red-900/30 border-red-500 text-red-400 cursor-default opacity-70";
                            }
                        } else {
                            btnClass += "bg-gray-800 border-gray-600 text-white hover:bg-gray-700 hover:scale-105 active:scale-95";
                        }

                        return (
                            <button
                                key={letter}
                                onClick={() => onGuess(letter)}
                                disabled={isGuessed || disabled}
                                className={btnClass}
                                aria-label={`Guess letter ${letter}`}
                                aria-pressed={isGuessed}
                                tabIndex={isGuessed || disabled ? -1 : 0}
                            >
                                {letter}
                            </button>
                        );
                    })}
                </div>
            );
        };

        // ============================================
        // SETTINGS MODAL COMPONENT
        // ============================================

        const SettingsModal = ({ isOpen, onClose, settings, onUpdateSettings }) => {
            if (!isOpen) return null;

            return (
                <motion.div 
                    initial={{ opacity: 0 }}
                    animate={{ opacity: 1 }}
                    exit={{ opacity: 0 }}
                    className="fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4"
                    onClick={onClose}
                >
                    <motion.div 
                        initial={{ scale: 0.8, y: 50 }}
                        animate={{ scale: 1, y: 0 }}
                        className="glass-panel p-6 rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"
                        onClick={(e) => e.stopPropagation()}
                    >
                        <h2 className="text-3xl font-bold mb-6 text-nova-cyan">⚙️ SETTINGS</h2>
                        
                        <div className="space-y-6">
                            {/* Theme Mode */}
                            <div>
                                <label className="block text-sm font-semibold mb-2 text-gray-300">Theme Mode</label>
                                <div className="flex gap-4">
                                    <button
                                        onClick={() => onUpdateSettings({ ...settings, lightMode: false })}
                                        className={`flex-1 py-2 rounded ${!settings.lightMode ? 'bg-nova-cyan text-black' : 'bg-gray-700 text-white'}`}
                                    >
                                        🌙 Dark
                                    </button>
                                    <button
                                        onClick={() => onUpdateSettings({ ...settings, lightMode: true })}
                                        className={`flex-1 py-2 rounded ${settings.lightMode ? 'bg-nova-cyan text-black' : 'bg-gray-700 text-white'}`}
                                    >
                                        ☀️ Light
                                    </button>
                                </div>
                            </div>

                            {/* Figure Type */}
                            <div>
                                <label className="block text-sm font-semibold mb-2 text-gray-300">Figure Type</label>
                                <select
                                    value={settings.figureType}
                                    onChange={(e) => onUpdateSettings({ ...settings, figureType: e.target.value })}
                                    className="w-full p-2 rounded bg-gray-700 text-white border border-gray-600"
                                >
                                    {Object.entries(FIGURE_TYPES).map(([key, label]) => (
                                        <option key={key} value={key}>{label}</option>
                                    ))}
                                </select>
                            </div>

                            {/* Color Settings */}
                            <div>
                                <label className="block text-sm font-semibold mb-2 text-gray-300">Figure Color</label>
                                <div className="flex gap-4">
                                    <button
                                        onClick={() => onUpdateSettings({ ...settings, randomFigureColor: false })}
                                        className={`flex-1 py-2 rounded ${!settings.randomFigureColor ? 'bg-nova-cyan text-black' : 'bg-gray-700 text-white'}`}
                                    >
                                        Fixed
                                    </button>
                                    <button
                                        onClick={() => onUpdateSettings({ ...settings, randomFigureColor: true })}
                                        className={`flex-1 py-2 rounded ${settings.randomFigureColor ? 'bg-nova-cyan text-black' : 'bg-gray-700 text-white'}`}
                                    >
                                        Random
                                    </button>
                                </div>
                                {!settings.randomFigureColor && (
                                    <input
                                        type="color"
                                        value={settings.fixedFigureColor}
                                        onChange={(e) => onUpdateSettings({ ...settings, fixedFigureColor: e.target.value })}
                                        className="mt-2 w-full h-10 rounded cursor-pointer"
                                    />
                                )}
                            </div>

                            <div>
                                <label className="block text-sm font-semibold mb-2 text-gray-300">Clothing Color</label>
                                <div className="flex gap-4">
                                    <button
                                        onClick={() => onUpdateSettings({ ...settings, randomClothingColor: false })}
                                        className={`flex-1 py-2 rounded ${!settings.randomClothingColor ? 'bg-nova-cyan text-black' : 'bg-gray-700 text-white'}`}
                                    >
                                        Fixed
                                    </button>
                                    <button
                                        onClick={() => onUpdateSettings({ ...settings, randomClothingColor: true })}
                                        className={`flex-1 py-2 rounded ${settings.randomClothingColor ? 'bg-nova-cyan text-black' : 'bg-gray-700 text-white'}`}
                                    >
                                        Random
                                    </button>
                                </div>
                            </div>

                            {/* Gallows */}
                            <div>
                                <label className="flex items-center gap-2 cursor-pointer">
                                    <input
                                        type="checkbox"
                                        checked={settings.showGallows}
                                        onChange={(e) => onUpdateSettings({ ...settings, showGallows: e.target.checked })}
                                        className="w-5 h-5"
                                    />
                                    <span className="text-gray-300">Show Gallows</span>
                                </label>
                            </div>

                            {/* Reverse Mode */}
                            <div>
                                <label className="flex items-center gap-2 cursor-pointer">
                                    <input
                                        type="checkbox"
                                        checked={settings.reverseMode}
                                        onChange={(e) => onUpdateSettings({ ...settings, reverseMode: e.target.checked })}
                                        className="w-5 h-5"
                                    />
                                    <span className="text-gray-300">Reverse Mode (Remove Instead of Add)</span>
                                </label>
                            </div>

                            {/* Extended Mode */}
                            <div>
                                <label className="flex items-center gap-2 cursor-pointer">
                                    <input
                                        type="checkbox"
                                        checked={settings.extendedMode}
                                        onChange={(e) => onUpdateSettings({ ...settings, extendedMode: e.target.checked })}
                                        className="w-5 h-5"
                                    />
                                    <span className="text-gray-300">Extended Mode (20 mistakes)</span>
                                </label>
                                <p className="text-xs text-gray-500 mt-1 ml-7">
                                    Note: Classic Stick Figure only supports 6 mistakes
                                </p>
                            </div>

{/* Difficulty */}
<div>
    <label className="block text-sm font-semibold mb-2 text-gray-300">Difficulty Level</label>
    <select
        value={settings.difficulty}
        onChange={(e) => onUpdateSettings({ ...settings, difficulty: e.target.value })}
        className="w-full p-2 rounded bg-gray-700 text-white border border-gray-600"
    >
        <optgroup label="Single Words">
            <option value="simple">Simple Words (Elementary)</option>
            <option value="common">Common Words (Middle School)</option>
            <option value="hard">Hard Words (High School)</option>
            <option value="challenging">Challenging Words (College)</option>
            <option value="ridiculous">Ridiculous Words (Expert)</option>
        </optgroup>
        <optgroup label="Phrases">
            <option value="simplePhrase">Simple Phrases (Elementary)</option>
            <option value="commonPhrase">Common Phrases (Idioms)</option>
            <option value="complicatedPhrase">Complicated Phrases (Literature)</option>
            <option value="hardPhrase">Hard Phrases (Advanced)</option>
            <option value="technicalPhrase">Technical Phrases (Expert)</option>
        </optgroup>
    </select>
</div>
                        </div>

                        <button 
                            onClick={onClose}
                            className="w-full mt-6 py-3 bg-nova-cyan hover:bg-cyan-400 text-black font-bold rounded-lg transition-all"
                        >
                            CLOSE
                        </button>
                    </motion.div>
                </motion.div>
            );
        };

        // ============================================
        // GAME STATE REDUCER
        // ============================================
        
        const gameReducer = (state, action) => {
            switch (action.type) {
                case 'SET_LOADING':
                    return {
                        ...state,
                        gameState: 'loading',
                        error: null
                    };
                
                case 'SET_WORD':
                    return {
                        ...state,
                        word: action.payload.word,
                        category: action.payload.category,
                        gameState: 'playing',
                        guessedLetters: new Set(),
                        error: action.payload.error || null
                    };
                
                case 'GUESS_LETTER':
                    const newGuessed = new Set(state.guessedLetters);
                    newGuessed.add(action.payload);
                    return {
                        ...state,
                        guessedLetters: newGuessed
                    };
                
                case 'SET_GAME_STATE':
                    return {
                        ...state,
                        gameState: action.payload
                    };
                
                case 'UPDATE_STATS':
                    return {
                        ...state,
                        wins: action.payload.wins,
                        losses: action.payload.losses
                    };
                
                case 'RESET_GAME':
                    return {
                        ...state,
                        guessedLetters: new Set(),
                        gameState: 'loading',
                        error: null
                    };

                case 'REVEAL_ANSWER':
                    const allLetters = new Set(state.word.split('').filter(c => c !== ' '));
                    return {
                        ...state,
                        guessedLetters: allLetters,
                        gameState: 'revealed'
                    };
                
                default:
                    return state;
            }
        };

        // ============================================
        // MAIN APP COMPONENT
        // ============================================
        
        const App = () => {
            const [state, dispatch] = useReducer(gameReducer, {
                word: "",
                category: "",
                guessedLetters: new Set(),
                gameState: "loading",
                error: null,
                wins: 0,
                losses: 0
            });

            const [settings, setSettings] = useState({
                difficulty: 'simple',
                lightMode: false,
                showGallows: true,
                figureType: 'man',
                randomFigureColor: true,
                fixedFigureColor: '#00E5FF',
                randomClothingColor: true,
                randomFacialHairColor: true,
                randomEyeColor: true,
                reverseMode: false,
                extendedMode: false
            });

            const [currentColors, setCurrentColors] = useState({
                figure: '#00E5FF',
                clothing: '#FF6B6B',
                facialHair: '#2C3E50',
                eyes: '#4A90E2'
            });

            const [settingsOpen, setSettingsOpen] = useState(false);
            const [showGiveUp, setShowGiveUp] = useState(false);

            const { word, category, guessedLetters, gameState, error, wins, losses } = state;

            // Classic figure type forces 6 mistakes only
            const effectiveExtendedMode = settings.extendedMode && settings.figureType !== 'classic';

            useEffect(() => {
                if (settings.lightMode) {
                    document.body.classList.add('light-mode');
                } else {
                    document.body.classList.remove('light-mode');
                }
            }, [settings.lightMode]);

            const generateColors = useCallback(() => {
                setCurrentColors({
                    figure: settings.randomFigureColor ? getRandomColor(['#00E5FF', '#FF6B6B', '#08D9D6', '#FFA07A', '#F7DC6F']) : settings.fixedFigureColor,
                    clothing: settings.randomClothingColor ? getRandomColor(CLOTHING_COLORS) : CLOTHING_COLORS[0],
                    facialHair: settings.randomFacialHairColor ? getRandomColor(FACIAL_HAIR_COLORS) : FACIAL_HAIR_COLORS[0],
                    eyes: settings.randomEyeColor ? getRandomColor(EYE_COLORS) : EYE_COLORS[0]
                });
            }, [settings]);

const fetchWord = useCallback(async () => {
    dispatch({ type: 'SET_LOADING' });
    generateColors();
    
    const difficultyConfig = DIFFICULTY_LEVELS[settings.difficulty];
    const seed = -1; // Random seed
    
    // Generate multiple variations for better diversity
    const variations = [
        "Generate", "Create", "Provide", "Give me", "Suggest"
    ];
    const variation = variations[Math.floor(Math.random() * variations.length)];
    
    const prompt = encodeURIComponent(
        `${variation} ${difficultyConfig.prompt}`
    );
    
    try {
        const timestamp = Date.now();
        const url = `${API_CONFIG.endpoint}${prompt}?model=${API_CONFIG.model}&seed=${seed}&key=${API_CONFIG.key}&nocache=${timestamp}`;
        
        const response = await fetchWithRetry(url);
        
        if (!response.ok) {
            throw new Error(`API returned ${response.status}`);
        }
        
        let rawText = await response.text();
        let cleanText = sanitizeWord(rawText);
        
        // Validate word/phrase length
        if (cleanText.length < difficultyConfig.minLength || 
            cleanText.length > difficultyConfig.maxLength) {
            console.log(`Word length ${cleanText.length} outside range ${difficultyConfig.minLength}-${difficultyConfig.maxLength}, using fallback`);
            throw new Error("Word length out of range");
        }
        
        // Check if it's actually a valid word/phrase
        if (cleanText.length === 0 || !/[A-Z]/.test(cleanText)) {
            throw new Error("Invalid word received from API");
        }

        const categoryName = DIFFICULTY_LEVELS[settings.difficulty].name;

        dispatch({ 
            type: 'SET_WORD', 
            payload: { word: cleanText, category: categoryName, error: null }
        });
        
    } catch (err) {
        console.error("API Error, using fallback:", err);
        const fallbackWord = getRandomFallbackWord(settings.difficulty);
        const categoryName = DIFFICULTY_LEVELS[settings.difficulty].name;
        
        dispatch({ 
            type: 'SET_WORD', 
            payload: { 
                word: fallbackWord,
                category: categoryName,
                error: "Connection issue - Using offline mode"
            }
        });
    }
}, [settings.difficulty, generateColors]);

            useEffect(() => {
                fetchWord();
            }, [fetchWord]);

            const maxMistakes = effectiveExtendedMode ? GAME_CONFIG.extendedMaxMistakes : GAME_CONFIG.standardMaxMistakes;

            const wrongCount = useMemo(() => {
                return Array.from(guessedLetters).filter(letter => !word.includes(letter)).length;
            }, [guessedLetters.size, word]);

            useEffect(() => {
                if (wrongCount >= GAME_CONFIG.standardMaxMistakes && !showGiveUp && effectiveExtendedMode) {
                    setShowGiveUp(true);
                }
            }, [wrongCount, showGiveUp, effectiveExtendedMode]);

            useEffect(() => {
                if (gameState !== "playing" || !word) return;

                const lettersToGuess = word.split('').filter(char => char !== ' ');
                const isWon = lettersToGuess.every(char => guessedLetters.has(char));
                
                if (isWon) {
                    const isStandardWin = wrongCount < GAME_CONFIG.standardMaxMistakes;
                    if (isStandardWin) {
                        dispatch({ type: 'UPDATE_STATS', payload: { wins: wins + 1, losses } });
                    } else {
                        dispatch({ type: 'UPDATE_STATS', payload: { wins, losses: losses + 1 } });
                    }
                    dispatch({ type: 'SET_GAME_STATE', payload: 'won' });
                    setShowGiveUp(false);
                    return;
                }

                if (wrongCount >= maxMistakes) {
                    dispatch({ type: 'UPDATE_STATS', payload: { wins, losses: losses + 1 } });
                    dispatch({ type: 'SET_GAME_STATE', payload: 'lost' });
                    setShowGiveUp(false);
                }
            }, [wrongCount, guessedLetters, word, gameState, maxMistakes, wins, losses]);

            const handleGuess = useCallback((letter) => {
                if (gameState !== "playing" || guessedLetters.has(letter)) return;
                dispatch({ type: 'GUESS_LETTER', payload: letter });
            }, [gameState, guessedLetters]);

            const resetGame = useCallback(() => {
                dispatch({ type: 'RESET_GAME' });
                setShowGiveUp(false);
                fetchWord();
            }, [fetchWord]);

            const handleGiveUp = useCallback(() => {
                dispatch({ type: 'UPDATE_STATS', payload: { wins, losses: losses + 1 } });
                dispatch({ type: 'REVEAL_ANSWER' });
                setShowGiveUp(false);
            }, [wins, losses]);

            useEffect(() => {
                const handleKeyDown = (e) => {
                    if (/^[a-zA-Z]$/.test(e.key)) {
                        e.preventDefault();
                    }
                    
                    const key = e.key.toUpperCase();
                    if (/^[A-Z]$/.test(key) && gameState === "playing" && !guessedLetters.has(key)) {
                        dispatch({ type: 'GUESS_LETTER', payload: key });
                    }
                };
                
                window.addEventListener("keydown", handleKeyDown);
                return () => window.removeEventListener("keydown", handleKeyDown);
            }, [gameState, guessedLetters]);

            const [announcement, setAnnouncement] = useState('');

            useEffect(() => {
                if (gameState === 'won') {
                    setAnnouncement(`Congratulations! You won! The word was ${word}`);
                } else if (gameState === 'lost') {
                    setAnnouncement(`Game over. The word was ${word}`);
                } else if (gameState === 'revealed') {
                    setAnnouncement(`You gave up. The word was ${word}`);
                } else if (gameState === 'playing') {
                    setAnnouncement(`${wrongCount} mistakes out of ${maxMistakes}`);
                }
            }, [gameState, wrongCount, word, maxMistakes]);

            return (
                <div className={`min-h-screen ${settings.lightMode ? 'bg-gray-100 text-gray-900' : 'bg-nova-dark text-white'} flex flex-col items-center justify-center p-4 font-mono relative`}>
                    
                    <div 
                        role="status" 
                        aria-live="polite" 
                        aria-atomic="true"
                        className="sr-only"
                    >
                        {announcement}
                    </div>

                    {!settings.lightMode && (
                        <div className="absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none z-0">
                            <div className="absolute top-10 left-10 w-64 h-64 bg-nova-cyan/5 rounded-full blur-3xl animate-pulse-slow"></div>
                            <div className="absolute bottom-10 right-10 w-96 h-96 bg-purple-500/5 rounded-full blur-3xl animate-pulse-slow" style={{ animationDelay: '1s' }}></div>
                        </div>
                    )}

                    <header className="z-10 mb-4 text-center relative w-full">
                        <div className="absolute right-4 top-0">
                            <button
                                onClick={() => setSettingsOpen(true)}
                                className="settings-icon text-3xl"
                                aria-label="Open settings"
                            >
                                ⚙️
                            </button>
                        </div>
                        <h1 className="text-4xl md:text-6xl font-extrabold tracking-tighter mb-2">
                            NOVA<span className="text-nova-cyan neon-text">HANGMAN</span>
                        </h1>
                        <p className={`text-sm md:text-base ${settings.lightMode ? 'text-gray-600' : 'text-gray-400'}`}>
                            AI-Powered Word Challenge
                        </p>
                        <div className="mt-2 flex justify-center gap-6 text-sm">
                            <span className="text-green-400">Wins: {wins}</span>
                            <span className="text-red-400">Losses: {losses}</span>
                        </div>
                    </header>

                    <main id="main-content" className="z-10 w-full max-w-4xl flex flex-col items-center">
                        
                        <div className="mb-6 p-6 glass-panel rounded-2xl shadow-2xl">
                            <HangmanDrawing 
                                wrongGuesses={wrongCount} 
                                settings={{...settings, extendedMode: effectiveExtendedMode}}
                                currentColors={currentColors}
                                figureType={settings.figureType}
                                isReverse={settings.reverseMode}
                            />
                        </div>

                        <div className="mb-4 h-8 text-center min-w-[200px]">
                            {error && (
                                <motion.span 
                                    initial={{ opacity: 0 }}
                                    animate={{ opacity: 1 }}
                                    className="text-yellow-400 text-xs md:text-sm"
                                >
                                    ⚠️ {error}
                                </motion.span>
                            )}
                            {!error && gameState === 'playing' && (
                                <span className={`text-sm md:text-base ${settings.lightMode ? 'text-gray-700' : 'text-gray-400'}`}>
                                    Mistakes: <span className={`font-bold ${settings.lightMode ? 'text-black' : 'text-white'}`}>{wrongCount}</span> / {maxMistakes}
                                </span>
                            )}
                        </div>

                        {showGiveUp && gameState === 'playing' && (
                            <motion.button
                                initial={{ opacity: 0, y: -10 }}
                                animate={{ opacity: 1, y: 0 }}
                                onClick={handleGiveUp}
                                className="mb-4 px-6 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg transition-all"
                            >
                                GIVE UP
                            </motion.button>
                        )}

                        {word && <WordDisplay word={word} guessedLetters={guessedLetters} category={category} />}

                        {gameState === 'playing' && (
                            <motion.div
                                initial={{ opacity: 0, y: 20 }}
                                animate={{ opacity: 1, y: 0 }}
                                transition={{ delay: 0.3 }}
                                className="w-full"
                            >
                                <Keyboard 
                                    onGuess={handleGuess} 
                                    guessedLetters={guessedLetters} 
                                    word={word}
                                    disabled={false} 
                                />
                            </motion.div>
                        )}
                    </main>

                    <AnimatePresence>
                        {(gameState === 'won' || gameState === 'lost' || gameState === 'revealed') && (
                            <motion.div 
                                initial={{ opacity: 0 }}
                                animate={{ opacity: 1 }}
                                exit={{ opacity: 0 }}
                                className="fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4"
                                role="dialog"
                                aria-modal="true"
                                aria-labelledby="game-result-title"
                            >
                                <motion.div 
                                    initial={{ scale: 0.8, y: 50 }}
                                    animate={{ scale: 1, y: 0 }}
                                    transition={{ type: "spring", damping: 15 }}
                                    className="glass-panel p-8 rounded-2xl max-w-md w-full text-center shadow-2xl"
                                >
                                    <h2 
                                        id="game-result-title"
                                        className={`text-3xl md:text-4xl font-bold mb-4 ${
                                            gameState === 'won' ? 'text-green-400' : 'text-red-500'
                                        }`}
                                    >
                                        {gameState === 'won' ? '🎉 VICTORY!' : gameState === 'revealed' ? '🏳️ GAVE UP' : '🙃 GAME OVER'}
                                    </h2>
                                    
                                    <div className="mb-6">
                                        <p className="text-gray-400 text-xs md:text-sm uppercase tracking-widest mb-2">
                                            The Word Was
                                        </p>
                                        <p className="text-2xl md:text-3xl font-bold text-white mb-4">
                                            {word}
                                        </p>
                                        <p className="text-gray-500 text-sm">
                                            {gameState === 'won' 
                                                ? wrongCount < GAME_CONFIG.standardMaxMistakes 
                                                    ? `Solved with ${wrongCount} mistake${wrongCount !== 1 ? 's' : ''}!`
                                                    : `Completed with ${wrongCount} mistakes (counts as loss)`
                                                : gameState === 'revealed'
                                                ? 'Try again next time!'
                                                : 'Better luck next time!'
                                            }
                                        </p>
                                    </div>

                                    <button 
                                        onClick={resetGame}
                                        className="w-full py-3 md:py-4 bg-nova-cyan hover:bg-cyan-400 text-black font-bold rounded-lg transition-all transform hover:scale-105 active:scale-95"
                                        aria-label="Start a new game"
                                    >
                                        PLAY AGAIN
                                    </button>
                                </motion.div>
                            </motion.div>
                        )}
                    </AnimatePresence>

                    <AnimatePresence>
                        {gameState === 'loading' && (
                            <motion.div 
                                initial={{ opacity: 0 }}
                                animate={{ opacity: 1 }}
                                exit={{ opacity: 0 }}
                                className={`fixed inset-0 z-50 ${settings.lightMode ? 'bg-gray-100' : 'bg-nova-dark'} flex flex-col items-center justify-center`}
                                role="status"
                                aria-label="Loading new word"
                            >
                                <div className={`w-16 h-16 border-4 ${settings.lightMode ? 'border-gray-300 border-t-gray-700' : 'border-gray-700 border-t-nova-cyan'} rounded-full animate-spin mb-4`}></div>
                                <p className="text-nova-cyan animate-pulse font-mono">
                                    INITIALIZING NOVA CORE...
                                </p>
                            </motion.div>
                        )}
                    </AnimatePresence>

                    <AnimatePresence>
                        <SettingsModal 
                            isOpen={settingsOpen}
                            onClose={() => setSettingsOpen(false)}
                            settings={settings}
                            onUpdateSettings={setSettings}
                        />
                    </AnimatePresence>

                    <footer className="z-10 mt-8 text-center text-xs" style={{ color: settings.lightMode ? '#666' : '#666' }}>
                        <p>Press any letter key to guess • Made with React & Framer Motion</p>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(
            <ErrorBoundary>
                <App />
            </ErrorBoundary>
        );
    </script>
</body>
</html>
